<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Stoner.Plot &mdash; Stoner Pacakge API Documentation</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Stoner Pacakge API Documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Stoner Package</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for Stoner.Plot</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;         Stoner.Plot</span>
<span class="sd">            ============</span>

<span class="sd">Provides the a class to facilitate easier plotting of Stoner Data:</span>

<span class="sd">Classes:</span>
<span class="sd">    PlotFile - A class that uses matplotlib to plot data</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">Stoner.compat</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">Stoner.Core</span> <span class="kn">import</span> <span class="n">DataFile</span><span class="p">,</span> <span class="n">_attribute_store</span><span class="p">,</span> <span class="n">copy_into</span><span class="p">,</span><span class="n">isNone</span>
<span class="kn">from</span> <span class="nn">Stoner.PlotFormats</span> <span class="kn">import</span> <span class="n">DefaultPlotStyle</span>
<span class="kn">from</span> <span class="nn">Stoner.plotutils</span> <span class="kn">import</span> <span class="n">errorfill</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">_np_</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">getargspec</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;posix&quot;</span> <span class="ow">and</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;Darwin&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&#39;MacOSX&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">figure</span> <span class="k">as</span> <span class="n">mplfig</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid</span> <span class="kn">import</span> <span class="n">inset_locator</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="kn">as</span> <span class="nn">colors</span>
<span class="kn">from</span> <span class="nn">colorsys</span> <span class="kn">import</span> <span class="n">hls_to_rgb</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">host_subplot</span>
<span class="kn">import</span> <span class="nn">mpl_toolkits.axisartist</span> <span class="kn">as</span> <span class="nn">AA</span>

<div class="viewcode-block" id="PlotFile"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.html#Stoner.Plot.PlotFile">[docs]</a><span class="k">class</span> <span class="nc">PlotFile</span><span class="p">(</span><span class="n">DataFile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extends DataFile with plotting functions.</span>

<span class="sd">    Args:</span>
<span class="sd">        args(tuple): Arguements to pass to :py:meth:`Stoner.Core.DataFile.__init__`</span>
<span class="sd">        kargs (dict):  keyword arguments to pass to \b DataFile.__init__</span>

<span class="sd">    Attributes:</span>
<span class="sd">        fig (matplotlib.figure): The current figure object being worked with</span>
<span class="sd">        labels (list of string): List of axis labels as aternates to the column_headers</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">positional_fmt</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">]</span>
    <span class="n">no_fmt</span> <span class="o">=</span> <span class="p">[</span><span class="n">errorfill</span><span class="p">]</span>

<div class="viewcode-block" id="PlotFile.__init__"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.__init__.html#Stoner.Plot.PlotFile.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>  <span class="c">#Do the import of plt here to speed module load</span>
        <span class="sd">&quot;&quot;&quot;Constructor of \b PlotFile class. Imports plt and then calls the parent constructor.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s">&quot;template&quot;</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>  <span class="c">#Setup the template</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;template&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="s">&quot;template&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">DefaultPlotStyle</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlotFile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_headers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subplots</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span> <span class="o">=</span> <span class="s">&quot;common&quot;</span>

<span class="c">#============================================================================================================================</span>
<span class="c">#Properties of PlotFile</span>
<span class="c">#============================================================================================================================</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>

    <span class="nd">@ax.setter</span>
    <span class="k">def</span> <span class="nf">ax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">value</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s">&quot;Figure doesn&#39;t have enough axes&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">mplfig</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@DataFile.clone.getter</span>
    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">copy_into</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">column_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DataFile</span><span class="o">.</span><span class="n">column_headers</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@column_headers.setter</span>
    <span class="k">def</span> <span class="nf">column_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="n">DataFile</span><span class="o">.</span><span class="n">column_headers</span><span class="o">.</span><span class="n">fset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span>

    <span class="nd">@fig.setter</span>
    <span class="k">def</span> <span class="nf">fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fignum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="o">.</span><span class="n">number</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_headers</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_headers</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">):]))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span>

    <span class="nd">@labels.setter</span>
    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">subplots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subplots</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subplots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subplots</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_template</span>

    <span class="nd">@template.setter</span>
    <span class="k">def</span> <span class="nf">template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">DefaultPlotStyle</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_template</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">DefaultPlotStyle</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_template</span> <span class="o">=</span> <span class="n">value</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Template is not of the right class&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_template</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>




    <span class="k">def</span> <span class="nf">_Plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">plotter</span><span class="p">,</span> <span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kwords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Private method for plotting a single plot to a figure.</span>

<span class="sd">        Args:</span>
<span class="sd">            ix (int): COlumn index of x data</span>
<span class="sd">            iy (int): Column index of y data</span>
<span class="sd">            fmt (str): Format of this plot</span>
<span class="sd">            plotter (callable): Routine used to plot this data</span>
<span class="sd">            figure (matplotlib.figure): Figure to plot data</span>
<span class="sd">            **kwords (dict): Other keyword arguments to pass through</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s">&quot;label&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwords</span><span class="p">:</span>
            <span class="n">kwords</span><span class="p">[</span><span class="s">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="n">iy</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">iy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional_fmt</span><span class="p">:</span>  <span class="c">#plots with positional fmt</span>
            <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">plotter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kwords</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plotter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kwords</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_fmt</span><span class="p">:</span>
            <span class="n">plotter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kwords</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span>
            <span class="n">plotter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kwords</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">figure</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_template</span><span class="o">.</span><span class="n">customise_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__SurfPlotter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Utility private function to plot a 3D color mapped surface.</span>

<span class="sd">        Args:</span>
<span class="sd">            X data</span>
<span class="sd">            Y Y data</span>
<span class="sd">            Z data</span>
<span class="sd">            kargs (dict): Other keywords to pass through</span>

<span class="sd">        ReturnsL</span>
<span class="sd">            A matplotib Figure</span>

<span class="sd">        This function attempts to work the same as the 2D surface plotter pcolor, but draws a 3D axes set&quot;&quot;&quot;</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">&quot;3d&quot;</span><span class="p">)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
        <span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">surf</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s">&quot;both&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">surf</span>

    <span class="k">def</span> <span class="nf">_VectorFieldPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper function to plot vector fields using mayavi.mlab.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (array): X data co-ordinates</span>
<span class="sd">            Y (array): Y data co-ordinates</span>
<span class="sd">            Z (array): Z data co-ordinates</span>
<span class="sd">            U (array): U data vector field component</span>
<span class="sd">            V (array): V data vector field component</span>
<span class="sd">            W (array): W data vector field component</span>

<span class="sd">        Returns:</span>
<span class="sd">            An mlab figure reference.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">mayavi</span> <span class="kn">import</span> <span class="n">mlab</span>  <span class="c"># might not work !</span>
            <span class="kn">from</span> <span class="nn">tvtk.api</span> <span class="kn">import</span> <span class="n">tvtk</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="s">&quot;scalars&quot;</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
            <span class="n">col_mode</span> <span class="o">=</span> <span class="s">&quot;color_by_scalar&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">col_mode</span> <span class="o">=</span> <span class="s">&quot;color_by_vector&quot;</span>
        <span class="k">if</span> <span class="s">&quot;scalars&quot;</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="s">&quot;scalars&quot;</span><span class="p">],</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;scalars&quot;</span><span class="p">]:</span>  <span class="c"># fancy mode on</span>
            <span class="k">del</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;scalars&quot;</span><span class="p">]</span>
            <span class="n">pi</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">pi</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">hsl2rgb</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">/</span> <span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">/</span> <span class="n">_np_</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">quiv</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">quiver3d</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">scalars</span><span class="o">=</span><span class="n">_np_</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)),</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
            <span class="n">quiv</span><span class="o">.</span><span class="n">glyph</span><span class="o">.</span><span class="n">color_mode</span> <span class="o">=</span> <span class="n">col_mode</span>
            <span class="n">sc</span> <span class="o">=</span> <span class="n">tvtk</span><span class="o">.</span><span class="n">UnsignedCharArray</span><span class="p">()</span>
            <span class="n">sc</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
            <span class="n">quiv</span><span class="o">.</span><span class="n">mlab_source</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">point_data</span><span class="o">.</span><span class="n">scalars</span> <span class="o">=</span> <span class="n">sc</span>
            <span class="n">quiv</span><span class="o">.</span><span class="n">mlab_source</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">modified</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quiv</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">quiver3d</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
            <span class="n">quiv</span><span class="o">.</span><span class="n">glyph</span><span class="o">.</span><span class="n">color_mode</span> <span class="o">=</span> <span class="n">col_mode</span>
        <span class="k">return</span> <span class="n">quiv</span>

    <span class="k">def</span> <span class="nf">_col_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Look up a column and see if it exists in self._lables, otherwise get from self.column_headers.</span>

<span class="sd">        Args:</span>
<span class="sd">            index (column index type): Column to return label for</span>

<span class="sd">        Returns:</span>
<span class="sd">            String type representing the column label.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">join</span><span class="p">:</span>
                <span class="k">return</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ix</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ix</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ix</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_headers</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handles the local attributes as well as the inherited ones.&quot;&quot;&quot;</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">PlotFile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__dir__</span><span class="p">())</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s">&quot;fig&quot;</span><span class="p">,</span> <span class="s">&quot;axes&quot;</span><span class="p">,</span> <span class="s">&quot;labels&quot;</span><span class="p">,</span> <span class="s">&quot;subplots&quot;</span><span class="p">,</span> <span class="s">&quot;template&quot;</span><span class="p">])</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="s">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="s">&#39;xlim&#39;</span><span class="p">,</span> <span class="s">&#39;ylim&#39;</span><span class="p">))</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">attr</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_fix_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sorts out axis specs, replacing with contents from setas as necessary.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s">&quot;startx&quot;</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
            <span class="n">startx</span> <span class="o">=</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;startx&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;startx&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">startx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="s">&quot;multi_y&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
            <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;multi_y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setas</span><span class="o">.</span><span class="n">_get_cols</span><span class="p">(</span><span class="n">startx</span><span class="o">=</span><span class="n">startx</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;xcol&quot;</span><span class="p">,</span> <span class="s">&quot;ycol&quot;</span><span class="p">,</span> <span class="s">&quot;zcol&quot;</span><span class="p">,</span> <span class="s">&quot;ucol&quot;</span><span class="p">,</span> <span class="s">&quot;vcol&quot;</span><span class="p">,</span> <span class="s">&quot;wcol&quot;</span><span class="p">,</span> <span class="s">&quot;xerr&quot;</span><span class="p">,</span> <span class="s">&quot;yerr&quot;</span><span class="p">,</span> <span class="s">&quot;zerr&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;xcol&quot;</span> <span class="ow">and</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;xcol&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;xcol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">xcol</span>
            <span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;xerr&quot;</span> <span class="ow">and</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;xerr&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;xerr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">xerr</span>
            <span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">!=</span> <span class="s">&quot;xcol&quot;</span> <span class="ow">and</span> <span class="n">kargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;multi_y&quot;</span><span class="p">]:</span>
                    <span class="n">kargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">kargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;xcol&quot;</span><span class="p">,</span> <span class="s">&quot;ycol&quot;</span><span class="p">,</span> <span class="s">&quot;zcol&quot;</span><span class="p">,</span> <span class="s">&quot;ucol&quot;</span><span class="p">,</span> <span class="s">&quot;vcol&quot;</span><span class="p">,</span> <span class="s">&quot;wcol&quot;</span><span class="p">,</span> <span class="s">&quot;xerr&quot;</span><span class="p">,</span> <span class="s">&quot;yerr&quot;</span><span class="p">,</span> <span class="s">&quot;zerr&quot;</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">kargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_attribute_store</span><span class="p">(</span><span class="n">kargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_fix_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sorts out the matplotlib figure handling.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">figure</span><span class="p">:</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">mplfig</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="n">figure</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">mplfig</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
            <span class="n">figure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span>

    <span class="k">def</span> <span class="nf">_fix_kargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">otherkargs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fix parameters to the plotting function to provide defaults and no extransous arguments.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dictionary of correct arguments, dictionary of all arguments&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">defaults</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kargs</span><span class="p">)</span>
        <span class="c"># Defaults now a dictionary of default arugments overlaid with keyword argument values</span>
        <span class="c"># Now inspect the plotting function to see what it takes.</span>
        <span class="k">if</span> <span class="n">function</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">function</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">function</span><span class="p">,</span><span class="n">string_types</span><span class="p">):</span>
                <span class="k">if</span> <span class="s">&quot;projection&quot;</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
                    <span class="n">projection</span><span class="o">=</span><span class="n">kargs</span><span class="p">[</span><span class="s">&quot;projection&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">projection</span><span class="o">=</span><span class="s">&quot;rectilinear&quot;</span>
                <span class="n">function</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">():</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>

        <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">vargs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">defs</span><span class="p">)</span> <span class="o">=</span> <span class="n">getargspec</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
        <span class="c"># Manually overide the list of arguments that the plotting function takes if it takes keyword dictionary</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">otherkargs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">otherkargs</span><span class="p">)</span>
        <span class="n">nonkargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">nonkargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">nonkargs</span>

    <span class="k">def</span> <span class="nf">_fix_titles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">multiple</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Does the titling and labelling for a matplotlib plot.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_template</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">multiple</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&quot;show_plot&quot;</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;show_plot&quot;</span><span class="p">]:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">if</span> <span class="s">&quot;save_filename&quot;</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;save_filename&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;save_filename&quot;</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attribute accessor.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (string):  Name of attribute the following attributes are supported:</span>
<span class="sd">                * fig - the current plt figure reference</span>
<span class="sd">                * axes - the plt axes object for the current plot</span>
<span class="sd">                * xlim - the X axis limits</span>
<span class="sd">                * ylim - the Y axis limits</span>

<span class="sd">                All other attrbiutes are passed over to the parent class</span>
<span class="sd">                &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;_public_attrs&quot;</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PlotFile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s">&quot;fig&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">mplfig</span><span class="o">.</span><span class="n">Figure</span><span class="p">),</span>
                <span class="s">&quot;labels&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                <span class="s">&quot;template&quot;</span><span class="p">:</span> <span class="n">DefaultPlotStyle</span><span class="p">,</span>
                <span class="s">&quot;xlim&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
                <span class="s">&quot;ylim&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
                <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="n">string_types</span><span class="p">,</span>
                <span class="s">&quot;xlabel&quot;</span><span class="p">:</span> <span class="n">string_types</span><span class="p">,</span>
                <span class="s">&quot;ylabel&quot;</span><span class="p">:</span> <span class="n">string_types</span>
            <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">PlotFile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">mplfig</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Unknown attribute {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="o">.</span><span class="n">axes</span>
                <span class="k">if</span> <span class="s">&quot;get_{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="s">&quot;get_{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                    <span class="n">ret</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>  <span class="c"># Sort of a universal pass through to plt</span>
                    <span class="n">ret</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>  <span class="c"># Sort of a universal pass through to plt</span>
                    <span class="n">ret</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Unknown attribute {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the specified attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (string): The name of the attribute to set. The cuirrent attributes are supported:</span>
<span class="sd">                * fig - set the plt figure isntance to use</span>
<span class="sd">                * xlabel - set the X axis label text</span>
<span class="sd">                * ylabel - set the Y axis label text</span>
<span class="sd">                * title - set the plot title</span>
<span class="sd">                * subtitle - set the plot subtitle</span>
<span class="sd">                * xlim - set the x-axis limits</span>
<span class="sd">                * ylim - set the y-axis limits</span>

<span class="sd">            Only &quot;fig&quot; is supported in this class - everything else drops through to the parent class</span>
<span class="sd">            value (any): The value of the attribute to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span><span class="n">name</span><span class="p">),</span><span class="nb">property</span><span class="p">):</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">PlotFile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)):</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">PlotFile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s">&quot;set_{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
            <span class="n">tfig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
            <span class="n">tax</span> <span class="o">=</span> <span class="n">tfig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>  <span class="c"># protect the current axes and figure</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">)</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="s">&quot;set_{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">tfig</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">tax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">PlotFile</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="PlotFile.add_column"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.add_column.html#Stoner.Plot.PlotFile.add_column">[docs]</a>    <span class="k">def</span> <span class="nf">add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_data</span><span class="p">,</span> <span class="n">column_header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">func_args</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Appends a column of data or inserts a column to a datafile instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_data (:py:class:`numpy.array` or list or callable): Data to append or insert or a callable function that will generate new data</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            column_header (string): The text to set the column header to,</span>
<span class="sd">                if not supplied then defaults to &#39;col#&#39;</span>
<span class="sd">            index (int or string): The  index (numeric or string) to insert (or replace) the data</span>
<span class="sd">            func_args (dict): If column_data is a callable object, then this argument</span>
<span class="sd">                can be used to supply a dictionary of function arguments to the callable object.</span>
<span class="sd">            replace (bool): Replace the data or insert the data (default)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A :py:class:`DataFile` instance with the additonal column inserted.</span>

<span class="sd">        Note:</span>
<span class="sd">            Like most :py:class:`DataFile` methods, this method operates in-place in that it also modifies</span>
<span class="sd">            the original DataFile Instance as well as returning it.&quot;&quot;&quot;</span>

        <span class="c"># Call the parent method and then update this label</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlotFile</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">column_data</span><span class="p">,</span><span class="n">column_header</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">func_args</span><span class="p">,</span><span class="n">replace</span><span class="p">)</span>
        <span class="c">#Mostly this is duplicating the parent method</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column_headers</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">column_header</span>
        <span class="k">return</span> <span class="bp">self</span>

</div>
<div class="viewcode-block" id="PlotFile.colormap_xyz"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.colormap_xyz.html#Stoner.Plot.PlotFile.colormap_xyz">[docs]</a>    <span class="k">def</span> <span class="nf">colormap_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">plotter</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An xyz plot that forces the use of plt.contour.</span>

<span class="sd">        Args:</span>
<span class="sd">            xcol (index): Xcolumn index or label</span>
<span class="sd">            ycol (index): Y column index or label</span>
<span class="sd">            zcol (index): Z column index or label</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            shape (two-tuple): Number of points along x and y in the grid - defaults to a square of sidelength = square root of the length of the data.</span>
<span class="sd">            xlim (tuple): The xlimits, defaults to automatically determined from data</span>
<span class="sd">            ylim (tuple): The ylimits, defaults to automatically determined from data</span>
<span class="sd">            plotter (function): Function to use to plot data. Defaults to plt.contour</span>
<span class="sd">            show_plot (bool): Turn on interfactive plotting and show plot when drawn</span>
<span class="sd">            save_filename (string or None): If set to a string, save the plot with this filename</span>
<span class="sd">            figure (integer or matplotlib.figure or boolean): Controls which figure is used for the plot, or if a new figure is opened.</span>
<span class="sd">            **kargs (dict): Other arguments are passed on to the plotter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A matplotlib figure</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">plotter</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">plotter</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span>
        <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotter</span>
        <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;projection&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;rectilinear&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_xyz</span><span class="p">(</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="p">,</span> <span class="n">zcol</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PlotFile.contour_xyz"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.contour_xyz.html#Stoner.Plot.PlotFile.contour_xyz">[docs]</a>    <span class="k">def</span> <span class="nf">contour_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">plotter</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An xyz plot that forces the use of plt.contour.</span>

<span class="sd">        Args:</span>
<span class="sd">            xcol (index): Xcolumn index or label</span>
<span class="sd">            ycol (index): Y column index or label</span>
<span class="sd">            zcol (index): Z column index or label</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            shape (two-tuple): Number of points along x and y in the grid - defaults to a square of sidelength = square root of the length of the data.</span>
<span class="sd">            xlim (tuple): The xlimits, defaults to automatically determined from data</span>
<span class="sd">            ylim (tuple): The ylimits, defaults to automatically determined from data</span>
<span class="sd">            plotter (function): Function to use to plot data. Defaults to plt.contour</span>
<span class="sd">            show_plot (bool): Turn on interfactive plotting and show plot when drawn</span>
<span class="sd">            save_filename (string or None): If set to a string, save the plot with this filename</span>
<span class="sd">            figure (integer or matplotlib.figure or boolean): Controls which figure is used for the plot, or if a new figure is opened.</span>
<span class="sd">            **kargs (dict): Other arguments are passed on to the plotter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A matplotlib figure</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">plotter</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">plotter</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span>
        <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotter</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_xyz</span><span class="p">(</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="p">,</span> <span class="n">zcol</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PlotFile.figure"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.figure.html#Stoner.Plot.PlotFile.figure">[docs]</a>    <span class="k">def</span> <span class="nf">figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s">&quot;rectilinear&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the figure used by :py:class:`Stoner.Plot.PlotFile`.</span>

<span class="sd">        Args:</span>
<span class="sd">            figure A matplotlib figure or figure number</span>

<span class="sd">        Returns:</span>
<span class="sd">            The current \b Stoner.PlotFile instance&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">figure</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">mplfig</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="n">figure</span><span class="o">.</span><span class="n">number</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="PlotFile.griddata"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.griddata.html#Stoner.Plot.PlotFile.griddata">[docs]</a>    <span class="k">def</span> <span class="nf">griddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;linear&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function to convert xyz data onto a regular grid.</span>

<span class="sd">            Args:</span>
<span class="sd">            xcol (index): Column to be used for the X-Data</span>
<span class="sd">            ycol (index): column to be used for Y-Data - default value is column to the right of the x-data column</span>
<span class="sd">            zcol (index): column to be used for the Z-data - default value is the column to the right of the y-data column</span>

<span class="sd">            Keyword Arguments:</span>
<span class="sd">                shape (two-tuple): Number of points along x and y in the grid - defaults to a square of sidelength = square root of the length of the data.</span>
<span class="sd">                xlim (tuple): The xlimits</span>
<span class="sd">                ylim (tuple) The ylimits</span>
<span class="sd">                method (string): Type of interploation to use, default is linear</span>

<span class="sd">            ReturnsL</span>
<span class="sd">                X,Y,Z three two dimensional arrays of the co-ordinates of the interpolated data</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">None</span> <span class="ow">in</span> <span class="p">(</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="p">,</span> <span class="n">zcol</span><span class="p">):</span>
            <span class="k">if</span> <span class="s">&quot;_startx&quot;</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
                <span class="n">startx</span> <span class="o">=</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;_startx&quot;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;_startx&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">startx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setas</span><span class="o">.</span><span class="n">_get_cols</span><span class="p">(</span><span class="n">startx</span><span class="o">=</span><span class="n">startx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xcol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">xcol</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="s">&quot;xcol&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ycol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ycol</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="s">&quot;ycol&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">zcol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="s">&quot;zcol&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">zcol</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="s">&quot;zcol&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))),</span> <span class="n">_np_</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))))</span>
        <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">xcol</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_np_</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">xcol</span><span class="p">))</span> <span class="o">*</span>
                    <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">xlim</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;X limit specification not good.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">ycol</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_np_</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">ycol</span><span class="p">))</span> <span class="o">*</span>
                    <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ylim</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ylim</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ylim</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Y limit specification not good.&quot;</span><span class="p">)</span>

        <span class="n">np</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)]</span><span class="o">.</span><span class="n">T</span>

        <span class="n">points</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">xcol</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">ycol</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
        <span class="k">if</span> <span class="n">zcol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">zdata</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zcol</span><span class="p">,</span> <span class="n">_np_</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">zcol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c"># zcol is some data</span>
            <span class="n">zdata</span> <span class="o">=</span> <span class="n">zcol</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">zcol</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zdata</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">zdata</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">zdata</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">zdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">Z</span><span class="p">[:,:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">zdata</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">[:,:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="p">[:,:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Z</span>
</div>
<div class="viewcode-block" id="PlotFile.image_plot"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.image_plot.html#Stoner.Plot.PlotFile.image_plot">[docs]</a>    <span class="k">def</span> <span class="nf">image_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Grid up the three columns of data and plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            xcol (index): Column to be used for the X-Data</span>
<span class="sd">            ycol (index): column to be used for Y-Data - default value is column to the right of the x-data column</span>
<span class="sd">            zcol (index): column to be used for the Z-data - default value is the column to the right of the y-data column</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            shape (two-tuple): Number of points along x and y in the grid - defaults to a square of sidelength = square root of the length of the data.</span>
<span class="sd">            xlim (tuple): The xlimits, defaults to automatically determined from data</span>
<span class="sd">            ylim (tuple): The ylimits, defaults to automatically determined from data</span>
<span class="sd">            xlabel (string) X axes label. Deafult is None - guess from xvals or metadata</span>
<span class="sd">            ylabel (string): Y axes label, Default is None - guess from metadata</span>
<span class="sd">            zlabel (string): Z axis label, Default is None - guess from metadata</span>
<span class="sd">            plotter (function): Function to use to plot data. Defaults to plt.contour</span>
<span class="sd">            show_plot (bool): Turn on interfactive plotting and show plot when drawn</span>
<span class="sd">            save_filename (string or None): If set to a string, save the plot with this filename</span>
<span class="sd">            figure (integer or matplotlib.figure or boolean): Controls which figure is used for the plot, or if a new figure is opened.</span>
<span class="sd">            **kargs (dict): Other arguments are passed on to the plotter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A matplotlib figure</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fix_cols</span><span class="p">(</span><span class="n">xcol</span><span class="o">=</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="n">ycol</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">))</span>

        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">griddata</span><span class="p">(</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="p">,</span> <span class="n">zcol</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;origin&quot;</span><span class="p">:</span> <span class="s">&quot;lower&quot;</span><span class="p">,</span>
            <span class="s">&quot;interpolation&quot;</span><span class="p">:</span> <span class="s">&quot;bilinear&quot;</span><span class="p">,</span>
            <span class="s">&quot;plotter&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
            <span class="s">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span>
            <span class="s">&quot;figure&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span>
            <span class="s">&quot;xlabel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">xcol</span><span class="p">)),</span>
            <span class="s">&quot;ylabel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">ycol</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="n">kargs</span><span class="p">,</span> <span class="n">nonkargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_kargs</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">defaults</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_fig</span><span class="p">(</span><span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;figure&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s">&quot;cmap&quot;</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="s">&quot;cmap&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s">&quot;cmap&quot;</span> <span class="ow">in</span> <span class="n">nonkargs</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;cmap&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RunetimeError</span><span class="p">(</span><span class="s">&quot;Z Data has a bad shape: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
        <span class="n">aspect</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="n">aspect</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fix_titles</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;none&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">nonkargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>
</div>
<div class="viewcode-block" id="PlotFile.inset"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.inset.html#Stoner.Plot.PlotFile.inset">[docs]</a>    <span class="k">def</span> <span class="nf">inset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new set of axes as an inset to the current plot.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            parent (matplotlib axes): Which set of axes to add inset to, defaults to the current set</span>
<span class="sd">            loc (int or string): Inset location - can be a string like *top right* or *upper right* or a number.</span>
<span class="sd">            width,height (int,float or string) the dimensions of the inset specified as a integer %, or floating point fraction of the parent axes, or as a string measurement.</span>
<span class="sd">            kargs (dictionary): all other keywords are passed through to inset_locator.inset_axes</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new set of axes&quot;&quot;&quot;</span>

        <span class="n">locations</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;best&#39;</span><span class="p">,</span> <span class="s">&#39;upper right&#39;</span><span class="p">,</span> <span class="s">&#39;upper left&#39;</span><span class="p">,</span> <span class="s">&#39;lower left&#39;</span><span class="p">,</span> <span class="s">&#39;lower right&#39;</span><span class="p">,</span> <span class="s">&#39;right&#39;</span><span class="p">,</span> <span class="s">&#39;center left&#39;</span><span class="p">,</span>
                     <span class="s">&#39;center right&#39;</span><span class="p">,</span> <span class="s">&#39;lower center&#39;</span><span class="p">,</span> <span class="s">&#39;upper center&#39;</span><span class="p">,</span> <span class="s">&#39;center&#39;</span><span class="p">]</span>
        <span class="n">locations2</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;best&#39;</span><span class="p">,</span> <span class="s">&#39;top right&#39;</span><span class="p">,</span> <span class="s">&#39;top left&#39;</span><span class="p">,</span> <span class="s">&#39;bottom left&#39;</span><span class="p">,</span> <span class="s">&#39;bottom right&#39;</span><span class="p">,</span> <span class="s">&#39;outside&#39;</span><span class="p">,</span> <span class="s">&#39;leftside&#39;</span><span class="p">,</span>
                      <span class="s">&#39;rightside&#39;</span><span class="p">,</span> <span class="s">&#39;bottom&#39;</span><span class="p">,</span> <span class="s">&#39;top&#39;</span><span class="p">,</span> <span class="s">&#39;middle&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">:</span>
                <span class="n">loc</span> <span class="o">=</span> <span class="n">locations</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">locations2</span><span class="p">:</span>
                <span class="n">loc</span> <span class="o">=</span> <span class="n">locations2</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t work out where {} was supposed to be&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">width</span> <span class="o">=</span> <span class="s">&quot;{}%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="s">&quot;{}%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">RuntimeErroror</span><span class="p">(</span><span class="s">&quot;didn&#39;t Recognize width specification {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">height</span> <span class="o">=</span> <span class="s">&quot;{}%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">height</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="s">&quot;{}%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">height</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">RuntimeErroror</span><span class="p">(</span><span class="s">&quot;didn&#39;t Recognize width specification {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">inset_locator</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PlotFile.plot"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.plot.html#Stoner.Plot.PlotFile.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Try to make an appropriate plot based on the defined column assignments.</span>

<span class="sd">        The column assignments are examined to determine whether to plot and x,y plot or an x,y,z plot</span>
<span class="sd">        and whether to plot error bars (for an x,y plot). All keyword argume nts are passed through to</span>
<span class="sd">        the selected plotting routine.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setas</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span><span class="p">]:</span>
                <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setas</span><span class="o">.</span><span class="n">_get_cols</span><span class="p">(</span><span class="n">startx</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
                <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;_startx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="s">&quot;axes&quot;</span><span class="p">]</span>

        <span class="n">plotters</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_xy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_xyz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_xyuv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_xyuv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_xyzuvw</span><span class="p">]</span>
        <span class="k">if</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">axes</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">plotter</span> <span class="o">=</span> <span class="n">plotters</span><span class="p">[</span><span class="n">axes</span><span class="p">]</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">plotter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Unable to work out plot type !&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>
</div>
<div class="viewcode-block" id="PlotFile.plot_matrix"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.plot_matrix.html#Stoner.Plot.PlotFile.plot_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">plot_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">xvals</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">yvals</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">rectang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span>
                    <span class="n">show_plot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">zlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">figure</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">plotter</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a surface plot by assuming that the current dataset represents a regular matrix of points.</span>

<span class="sd">            Args:</span>
<span class="sd">                xvals (index, list or numpy.array): Either a column index or name or a list or numpytarray of column values. The default (None) uses the first column of data</span>
<span class="sd">                yvals (int or list): Either a row index or a list or numpy array of row values. The default (None) uses the column_headings interpreted as floats</span>
<span class="sd">                rectang (tuple):  a tuple of either 2 or 4 elements representing either the origin (row,column) or size (origin, number of rows, number of columns) of data to be used for the z0data matrix</span>

<span class="sd">            Keyword Arguments:</span>
<span class="sd">                cmap (matplotlib colour map): Surface colour map - defaults to the jet colour map</span>
<span class="sd">                show_plot (bool): True Turns on interactive plot control</span>
<span class="sd">                title (string): Optional parameter that specfies the plot title - otherwise the current DataFile filename is used</span>
<span class="sd">                xlabel (string) X axes label. Deafult is None - guess from xvals or metadata</span>
<span class="sd">                ylabel (string): Y axes label, Default is None - guess from metadata</span>
<span class="sd">                zlabel (string): Z axis label, Default is None - guess from metadata</span>
<span class="sd">                figure (matplotlib figure): Controls what matplotlib figure to use. Can be an integer, or a matplotlib.figure or False. If False then a new figure is always used, otherwise it will default to using the last figure used by this DataFile object.</span>
<span class="sd">                plotter (callable): Optional arguement that passes a plotting function into the routine. Sensible choices might be plt.plot (default), py.semilogy, plt.semilogx</span>
<span class="sd">                kwords (dict): A dictionary of other keyword arguments to pass into the plot function.</span>

<span class="sd">            Returns:</span>
<span class="sd">                The matplotib figure with the data plotted&quot;&quot;&quot;</span>
        <span class="c"># Sortout yvals values</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yvals</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c">#  Int means we&#39;re sepcifying a data row</span>
            <span class="k">if</span> <span class="n">rectang</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># we need to intitialise the rectang</span>
                <span class="n">rectang</span> <span class="o">=</span> <span class="p">(</span><span class="n">yvals</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c"># We&#39;ll sort the column origin later</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rectang</span><span class="p">,</span>
                            <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">yvals</span><span class="p">:</span>  <span class="c"># We have a rectang, but we need to adjust the row origin</span>
                <span class="n">rectang</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">yvals</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">yvals</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">yvals</span><span class="p">]</span>  <span class="c"># change the yvals into a numpy array</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yvals</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>  <span class="c"># We&#39;re given the yvals as a list already</span>
            <span class="n">yvals</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yvals</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">yvals</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># No yvals, so we&#39;l try column headings</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">index_types</span><span class="p">):</span>  <span class="c"># Do we have an xcolumn header to take away ?</span>
                <span class="n">xvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_headers</span><span class="p">[</span><span class="n">xvals</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
            <span class="k">elif</span> <span class="n">xvals</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># No xvals so we&#39;re going to be using the first column</span>
                <span class="n">xvals</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_headers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_headers</span>
            <span class="n">yvals</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">])</span>  <span class="c">#Ok try to construct yvals aray</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;uvals must be either an integer, list, tuple, numpy array or None&quot;</span><span class="p">)</span>
        <span class="c">#Sort out xvls values</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">index_types</span><span class="p">):</span>  <span class="c"># String or int means using a column index</span>
            <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rectang</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># Do we need to init the rectan ?</span>
                <span class="n">rectang</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xvals</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rectang</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>  <span class="c"># Do we need to adjust the rectan column origin ?</span>
                <span class="n">rectang</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xvals</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">xvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>  <span class="c"># Xvals as a data item</span>
            <span class="n">xvals</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xvals</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">_np_</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">xvals</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># xvals from column 0</span>
            <span class="n">xvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rectang</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># and fix up rectang</span>
                <span class="n">rectang</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;xvals must be a string, integer, list, tuple or numpy array or None&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rectang</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rectang</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c"># Sort the rectang value</span>
            <span class="n">rectang</span> <span class="o">=</span> <span class="p">(</span><span class="n">rectang</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_np_</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">_np_</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">rectang</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rectang</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_np_</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_np_</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rectang</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rectang</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c"># Ok, just make sure we have enough data points left.</span>
            <span class="n">rectang</span> <span class="o">=</span> <span class="p">(</span><span class="n">rectang</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">rectang</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_np_</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                       <span class="nb">min</span><span class="p">(</span><span class="n">rectang</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">_np_</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;rectang should either be a 2 or 4 tuple or None&quot;</span><span class="p">)</span>

<span class="c">#Now we can create X,Y and Z 2D arrays</span>
        <span class="n">zdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">rectang</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">rectang</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">rectang</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">rectang</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
        <span class="n">xvals</span> <span class="o">=</span> <span class="n">xvals</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">rectang</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">yvals</span> <span class="o">=</span> <span class="n">yvals</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">rectang</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
        <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">yvals</span><span class="p">)</span>

        <span class="c">#This is the same as for the plot_xyz routine&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">figure</span><span class="p">:</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">mplfig</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="n">figure</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">mplfig</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
            <span class="n">figure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&quot;3d&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="k">if</span> <span class="n">show_plot</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">plotter</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__SurfPlotter</span>
        <span class="n">plotter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">zdata</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwords</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;xlabel&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="s">&quot;X Data&quot;</span><span class="p">),</span> <span class="s">&quot;ylabel&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="s">&quot;Y Data&quot;</span><span class="p">),</span> <span class="s">&quot;zlabel&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">zlabel</span><span class="p">,</span> <span class="s">&quot;Z Data&quot;</span><span class="p">)}</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
                    <span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s">&quot;xlabel&quot;</span><span class="p">]))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s">&quot;ylabel&quot;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">plotter</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__SurfPlotter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="s">&quot;zlabel&quot;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span>
</div>
<div class="viewcode-block" id="PlotFile.plot_xy"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.plot_xy.html#Stoner.Plot.PlotFile.plot_xy">[docs]</a>    <span class="k">def</span> <span class="nf">plot_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Makes a simple X-Y plot of the specified data.</span>

<span class="sd">        Args:</span>
<span class="sd">            xcol (index): Column to be used for the X-Data</span>
<span class="sd">            ycol (index): column to be used for Y-Data - default value is column to the right of the x-data column</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            fmt (strong or sequence of strings): Specifies the format for the plot - see matplotlib documentation for details</span>
<span class="sd">            xerr,yerr (index): Columns of data to get x and y errorbars from. Setting these turns the default plotter to plt.errorbar</span>
<span class="sd">            xlabel (string) X axes label. Deafult is None - guess from xvals or metadata</span>
<span class="sd">            ylabel (string): Y axes label, Default is None - guess from metadata</span>
<span class="sd">            zlabel (string): Z axis label, Default is None - guess from metadata</span>
<span class="sd">            title (string): Optional parameter that specfies the plot title - otherwise the current DataFile filename is used</span>
<span class="sd">            plotter (function): Function to use to plot data. Defaults to plt.plot unless error bars are set</span>
<span class="sd">            show_plot (bool): Turn on interfactive plotting and show plot when drawn</span>
<span class="sd">            save_filename (string or None): If set to a string, save the plot with this filename</span>
<span class="sd">            figure (integer or matplotlib.figure or boolean): Controls which figure is used for the plot, or if a new figure is opened.</span>
<span class="sd">            multiple (string): how to handle multiple y-axes with a common x axis. Options are:</span>

<span class="sd">                - *common* single y-axis (default)</span>
<span class="sd">                - *panels* panels sharing common x axis</span>
<span class="sd">                - *sub plots* sub plots</span>
<span class="sd">                - *y2* single axes with 2 y scales</span>

<span class="sd">            **kargs (dict): Other arguments are passed on to the plotter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A matplotlib.figure isntance</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_cols</span><span class="p">(</span><span class="n">xcol</span><span class="o">=</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="n">ycol</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">multi_y</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="s">&quot;xerr&quot;</span><span class="p">],</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;yerr&quot;</span><span class="p">])</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xerr</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">yerr</span><span class="p">)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;plotter&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span>
            <span class="s">&quot;show_plot&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">&quot;figure&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
            <span class="s">&quot;save_filename&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">&quot;xlabel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xcol</span><span class="p">)),</span>
            <span class="s">&quot;ylabel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">),</span> <span class="bp">True</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">otherargs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s">&quot;plotter&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xerr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">c</span><span class="o">.</span><span class="n">yerr</span> <span class="ow">is</span> <span class="ow">not</span>
                                       <span class="bp">None</span><span class="p">):</span>  <span class="c"># USe and errorbar blotter by default for errors</span>
            <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span>
            <span class="n">otherargs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;agg_filter&quot;</span><span class="p">,</span> <span class="s">&quot;alpha&quot;</span><span class="p">,</span> <span class="s">&quot;animated&quot;</span><span class="p">,</span> <span class="s">&quot;antialiased&quot;</span><span class="p">,</span> <span class="s">&quot;aa&quot;</span><span class="p">,</span> <span class="s">&quot;axes&quot;</span><span class="p">,</span> <span class="s">&quot;clip_box&quot;</span><span class="p">,</span> <span class="s">&quot;clip_on&quot;</span><span class="p">,</span>
                         <span class="s">&quot;clip_path&quot;</span><span class="p">,</span> <span class="s">&quot;color&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;contains&quot;</span><span class="p">,</span> <span class="s">&quot;dash_capstyle&quot;</span><span class="p">,</span> <span class="s">&quot;dash_joinstyle&quot;</span><span class="p">,</span> <span class="s">&quot;dashes&quot;</span><span class="p">,</span>
                         <span class="s">&quot;drawstyle&quot;</span><span class="p">,</span> <span class="s">&quot;fillstyle&quot;</span><span class="p">,</span> <span class="s">&quot;gid&quot;</span><span class="p">,</span> <span class="s">&quot;label&quot;</span><span class="p">,</span> <span class="s">&quot;linestyle&quot;</span><span class="p">,</span> <span class="s">&quot;ls&quot;</span><span class="p">,</span> <span class="s">&quot;linewidth&quot;</span><span class="p">,</span> <span class="s">&quot;lw&quot;</span><span class="p">,</span> <span class="s">&quot;lod&quot;</span><span class="p">,</span>
                         <span class="s">&quot;marker&quot;</span><span class="p">,</span> <span class="s">&quot;markeredgecolor&quot;</span><span class="p">,</span> <span class="s">&quot;mec&quot;</span><span class="p">,</span> <span class="s">&quot;markeredgewidth&quot;</span><span class="p">,</span> <span class="s">&quot;mew&quot;</span><span class="p">,</span> <span class="s">&quot;markerfacecolor&quot;</span><span class="p">,</span> <span class="s">&quot;mfc&quot;</span><span class="p">,</span>
                         <span class="s">&quot;markerfacecoloralt&quot;</span><span class="p">,</span> <span class="s">&quot;mfcalt&quot;</span><span class="p">,</span> <span class="s">&quot;markersize&quot;</span><span class="p">,</span> <span class="s">&quot;ms&quot;</span><span class="p">,</span> <span class="s">&quot;markevery&quot;</span><span class="p">,</span> <span class="s">&quot;path_effects&quot;</span><span class="p">,</span> <span class="s">&quot;picker&quot;</span><span class="p">,</span>
                         <span class="s">&quot;pickradius&quot;</span><span class="p">,</span> <span class="s">&quot;rasterized&quot;</span><span class="p">,</span> <span class="s">&quot;sketch_params&quot;</span><span class="p">,</span> <span class="s">&quot;snap&quot;</span><span class="p">,</span> <span class="s">&quot;solid_capstyle&quot;</span><span class="p">,</span> <span class="s">&quot;solid_joinstyle&quot;</span><span class="p">,</span>
                         <span class="s">&quot;transform&quot;</span><span class="p">,</span> <span class="s">&quot;url&quot;</span><span class="p">,</span> <span class="s">&quot;visible&quot;</span><span class="p">,</span> <span class="s">&quot;xdata&quot;</span><span class="p">,</span> <span class="s">&quot;ydata&quot;</span><span class="p">,</span> <span class="s">&quot;zorder&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s">&quot;plotter&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
            <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span>
            <span class="n">otherargs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;agg_filter&quot;</span><span class="p">,</span> <span class="s">&quot;alpha&quot;</span><span class="p">,</span> <span class="s">&quot;animated&quot;</span><span class="p">,</span> <span class="s">&quot;antialiased&quot;</span><span class="p">,</span> <span class="s">&quot;aa&quot;</span><span class="p">,</span> <span class="s">&quot;axes&quot;</span><span class="p">,</span> <span class="s">&quot;clip_box&quot;</span><span class="p">,</span> <span class="s">&quot;clip_on&quot;</span><span class="p">,</span>
                         <span class="s">&quot;clip_path&quot;</span><span class="p">,</span> <span class="s">&quot;color&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;contains&quot;</span><span class="p">,</span> <span class="s">&quot;dash_capstyle&quot;</span><span class="p">,</span> <span class="s">&quot;dash_joinstyle&quot;</span><span class="p">,</span> <span class="s">&quot;dashes&quot;</span><span class="p">,</span>
                         <span class="s">&quot;drawstyle&quot;</span><span class="p">,</span> <span class="s">&quot;fillstyle&quot;</span><span class="p">,</span> <span class="s">&quot;gid&quot;</span><span class="p">,</span> <span class="s">&quot;label&quot;</span><span class="p">,</span> <span class="s">&quot;linestyle&quot;</span><span class="p">,</span> <span class="s">&quot;ls&quot;</span><span class="p">,</span> <span class="s">&quot;linewidth&quot;</span><span class="p">,</span> <span class="s">&quot;lw&quot;</span><span class="p">,</span> <span class="s">&quot;lod&quot;</span><span class="p">,</span>
                         <span class="s">&quot;marker&quot;</span><span class="p">,</span> <span class="s">&quot;markeredgecolor&quot;</span><span class="p">,</span> <span class="s">&quot;mec&quot;</span><span class="p">,</span> <span class="s">&quot;markeredgewidth&quot;</span><span class="p">,</span> <span class="s">&quot;mew&quot;</span><span class="p">,</span> <span class="s">&quot;markerfacecolor&quot;</span><span class="p">,</span> <span class="s">&quot;mfc&quot;</span><span class="p">,</span>
                         <span class="s">&quot;markerfacecoloralt&quot;</span><span class="p">,</span> <span class="s">&quot;mfcalt&quot;</span><span class="p">,</span> <span class="s">&quot;markersize&quot;</span><span class="p">,</span> <span class="s">&quot;ms&quot;</span><span class="p">,</span> <span class="s">&quot;markevery&quot;</span><span class="p">,</span> <span class="s">&quot;path_effects&quot;</span><span class="p">,</span> <span class="s">&quot;picker&quot;</span><span class="p">,</span>
                         <span class="s">&quot;pickradius&quot;</span><span class="p">,</span> <span class="s">&quot;rasterized&quot;</span><span class="p">,</span> <span class="s">&quot;sketch_params&quot;</span><span class="p">,</span> <span class="s">&quot;snap&quot;</span><span class="p">,</span> <span class="s">&quot;solid_capstyle&quot;</span><span class="p">,</span> <span class="s">&quot;solid_joinstyle&quot;</span><span class="p">,</span>
                         <span class="s">&quot;transform&quot;</span><span class="p">,</span> <span class="s">&quot;url&quot;</span><span class="p">,</span> <span class="s">&quot;visible&quot;</span><span class="p">,</span> <span class="s">&quot;xdata&quot;</span><span class="p">,</span> <span class="s">&quot;ydata&quot;</span><span class="p">,</span> <span class="s">&quot;zorder&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">multiple</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">multiple</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span> <span class="o">=</span> <span class="n">multiple</span>
        <span class="n">kargs</span><span class="p">,</span> <span class="n">nonkargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_kargs</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">otherargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;xerr&quot;</span><span class="p">,</span> <span class="s">&quot;yerr&quot;</span><span class="p">]:</span>  <span class="c"># Check for x and y error keywords</span>
            <span class="k">if</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isNone</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">],</span> <span class="n">index_types</span><span class="p">):</span>
                    <span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">):</span>
                    <span class="c"># Ok, so it&#39;s a list, so redo the check for each  item.</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">])):</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">index_types</span><span class="p">):</span>
                            <span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">kargs</span><span class="p">[</span><span class="n">err</span><span class="p">]</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>


        <span class="n">temp_kwords</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">,</span> <span class="p">(</span><span class="n">index_types</span><span class="p">)):</span>
            <span class="n">c</span><span class="o">.</span><span class="n">ycol</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">multiple</span> <span class="o">==</span> <span class="s">&quot;panels&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;hspace&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
            <span class="k">elif</span> <span class="n">multiple</span> <span class="o">==</span> <span class="s">&quot;subplots&quot;</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">))))</span>
                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_fig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_fig</span><span class="p">(</span><span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;figure&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">multiple</span> <span class="o">!=</span> <span class="s">&quot;common&quot;</span><span class="p">:</span>
                <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;ylabel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">[</span><span class="n">ix</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">ix</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">multiple</span> <span class="o">==</span> <span class="s">&quot;y2&quot;</span> <span class="ow">and</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">y2</span><span class="p">()</span>
                    <span class="n">cc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">_get_lines</span><span class="o">.</span><span class="n">color_cycle</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ix</span><span class="p">):</span>
                        <span class="nb">next</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">multiple</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;y2&quot;</span><span class="p">,</span> <span class="s">&quot;panels&quot;</span><span class="p">,</span> <span class="s">&quot;subplots&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ix</span>  <span class="c"># We&#39;re manipulating the plotting here</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c"># Fix up the format</span>
                <span class="n">fmt_t</span> <span class="o">=</span> <span class="n">fmt</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fmt_t</span> <span class="o">=</span> <span class="n">fmt</span>
            <span class="k">if</span> <span class="s">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="s">&quot;label&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>  <span class="c"># Fix label keywords</span>
                <span class="n">temp_kwords</span><span class="p">[</span><span class="s">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;label&quot;</span><span class="p">][</span><span class="n">ix</span><span class="p">]</span>
            <span class="k">if</span> <span class="s">&quot;yerr&quot;</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kargs</span><span class="p">[</span><span class="s">&quot;yerr&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>  <span class="c"># Fix yerr keywords</span>
                <span class="n">temp_kwords</span><span class="p">[</span><span class="s">&quot;yerr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;yerr&quot;</span><span class="p">][</span><span class="n">ix</span><span class="p">]</span>
            <span class="c"># Call plot</span>

            <span class="k">if</span> <span class="n">fmt_t</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">fmt_t</span><span class="p">,</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="o">**</span><span class="n">temp_kwords</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">fmt_t</span><span class="p">,</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="o">**</span><span class="n">temp_kwords</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fix_titles</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">multiple</span><span class="p">,</span> <span class="o">**</span><span class="n">nonkargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ix</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c"># Hooks for multiple subplots</span>
                <span class="k">if</span> <span class="n">multiple</span> <span class="o">==</span> <span class="s">&quot;panels&quot;</span><span class="p">:</span>
                    <span class="n">loc</span><span class="p">,</span> <span class="n">lab</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">()</span>
                    <span class="n">lab</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lab</span><span class="p">]</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">loc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lab</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span>
</div>
<div class="viewcode-block" id="PlotFile.plot_xyz"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.plot_xyz.html#Stoner.Plot.PlotFile.plot_xyz">[docs]</a>    <span class="k">def</span> <span class="nf">plot_xyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s">&quot;3d&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a surface plot based on rows of X,Y,Z data using matplotlib.pcolor().</span>

<span class="sd">            Args:</span>
<span class="sd">                xcol (index): Xcolumn index or label</span>
<span class="sd">                ycol (index): Y column index or label</span>
<span class="sd">                zcol (index): Z column index or label</span>

<span class="sd">            Keyword Arguments:</span>
<span class="sd">                shape (tuple): Defines the shape of the surface (i.e. the number of X and Y value. If not procided or None, then the routine will attempt to calculate these from the data provided</span>
<span class="sd">                xlim (tuple): Defines the x-axis limits and grid of the data to be plotted</span>
<span class="sd">                ylim (tuple) Defines the Y-axis limits and grid of the data data to be plotted</span>
<span class="sd">                cmap (matplotlib colour map): Surface colour map - defaults to the jet colour map</span>
<span class="sd">                show_plot (bool): True Turns on interactive plot control</span>
<span class="sd">                title (string): Optional parameter that specfies the plot title - otherwise the current DataFile filename is used</span>
<span class="sd">                save_filename (string): Filename used to save the plot</span>
<span class="sd">                figure (matplotlib figure): Controls what matplotlib figure to use. Can be an integer, or a matplotlib.figure or False. If False then a new figure is always used, otherwise it will default to using the last figure used by this DataFile object.</span>
<span class="sd">                plotter (callable): Optional arguement that passes a plotting function into the routine. Default is a 3d surface plotter, but contour plot and pcolormesh also work.</span>
<span class="sd">                projection (string or None): Whether to use a 3D projection or regular 2D axes (deault is 3D)</span>
<span class="sd">                **kargs (dict): A dictionary of other keyword arguments to pass into the plot function.</span>

<span class="sd">            Returns:</span>
<span class="sd">                A matplotlib.figure isntance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_cols</span><span class="p">(</span><span class="n">xcol</span><span class="o">=</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="n">ycol</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="n">zcol</span><span class="p">,</span> <span class="n">multi_y</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">zdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">griddata</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">zcol</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;plotter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__SurfPlotter</span><span class="p">,</span>
            <span class="s">&quot;show_plot&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">&quot;figure&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
            <span class="s">&quot;save_filename&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span>
            <span class="s">&quot;rstride&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">zdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">50</span><span class="p">),</span>
            <span class="s">&quot;cstride&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">zdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">50</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">coltypes</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;xlabel&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="s">&quot;ylabel&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">,</span> <span class="s">&quot;zlabel&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">zcol</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">coltypes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coltypes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">index_types</span><span class="p">):</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="n">coltypes</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
        <span class="k">if</span> <span class="s">&quot;plotter&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&quot;plotter&quot;</span> <span class="ow">in</span> <span class="n">kargs</span> <span class="ow">and</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__SurfPlotter</span><span class="p">):</span>
            <span class="n">otherkargs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;rstride&quot;</span><span class="p">,</span> <span class="s">&quot;cstride&quot;</span><span class="p">,</span> <span class="s">&quot;color&quot;</span><span class="p">,</span> <span class="s">&quot;cmap&quot;</span><span class="p">,</span> <span class="s">&quot;facecolors&quot;</span><span class="p">,</span> <span class="s">&quot;norm&quot;</span><span class="p">,</span> <span class="s">&quot;vmin&quot;</span><span class="p">,</span> <span class="s">&quot;vmax&quot;</span><span class="p">,</span> <span class="s">&quot;shade&quot;</span><span class="p">,</span><span class="s">&quot;linewidth&quot;</span><span class="p">,</span><span class="s">&quot;ax&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">otherkargs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;vmin&quot;</span><span class="p">,</span> <span class="s">&quot;vmax&quot;</span><span class="p">,</span><span class="s">&quot;shade&quot;</span><span class="p">,</span><span class="s">&quot;color&quot;</span><span class="p">,</span><span class="s">&quot;linewidth&quot;</span><span class="p">]</span>
        <span class="n">kargs</span><span class="p">,</span> <span class="n">nonkargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_kargs</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">otherkargs</span><span class="o">=</span><span class="n">otherkargs</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span><span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_fig</span><span class="p">(</span><span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;figure&quot;</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">plotter</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">plotter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot3d</span><span class="o">=</span><span class="n">plotter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">zdata</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">plotter</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__SurfPlotter</span><span class="p">:</span>
            <span class="k">del</span> <span class="p">(</span><span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;zlabel&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fix_titles</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;none&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">nonkargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span>
</div>
<div class="viewcode-block" id="PlotFile.plot_xyuv"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.plot_xyuv.html#Stoner.Plot.PlotFile.plot_xyuv">[docs]</a>    <span class="k">def</span> <span class="nf">plot_xyuv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ucol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Makes an overlaid image and quiver plot.</span>
<span class="sd">        Args:</span>
<span class="sd">                xcol (index): Xcolumn index or label</span>
<span class="sd">                ycol (index): Y column index or label</span>
<span class="sd">                zcol (index): Z column index or label</span>
<span class="sd">                ucol (index): U column index or label</span>
<span class="sd">                vcol (index): V column index or label</span>
<span class="sd">                wcol (index): W column index or label</span>

<span class="sd">            Keyword Arguments:</span>
<span class="sd">                show_plot (bool): True Turns on interactive plot control</span>
<span class="sd">                title (string): Optional parameter that specfies the plot title - otherwise the current DataFile filename is used</span>
<span class="sd">                save_filename (string): Filename used to save the plot</span>
<span class="sd">                figure (matplotlib figure): Controls what matplotlib figure to use. Can be an integer, or a matplotlib.figure or False. If False then a new figure is always used, otherwise it will default to using the last figure used by this DataFile object.</span>
<span class="sd">                plotter (callable): Optional arguement that passes a plotting function into the routine. Default is a 3d surface plotter, but contour plot and pcolormesh also work.</span>
<span class="sd">                **kargs (dict): A dictionary of other keyword arguments to pass into the plot function.</span>
<span class="sd">                &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_cols</span><span class="p">(</span><span class="n">xcol</span><span class="o">=</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="n">ycol</span><span class="p">,</span> <span class="n">ucol</span><span class="o">=</span><span class="n">ucol</span><span class="p">,</span> <span class="n">vcol</span><span class="o">=</span><span class="n">vcol</span><span class="p">,</span> <span class="n">wcol</span><span class="o">=</span><span class="n">wcol</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">wcol</span><span class="p">,</span> <span class="n">index_types</span><span class="p">):</span>
            <span class="n">wdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">wcol</span><span class="p">)</span>
            <span class="n">phidata</span> <span class="o">=</span> <span class="p">(</span><span class="n">wdata</span> <span class="o">-</span> <span class="n">_np_</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wdata</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">wdata</span><span class="p">)</span> <span class="o">-</span> <span class="n">_np_</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">wdata</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phidata</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.5</span>
            <span class="n">wdata</span> <span class="o">=</span> <span class="n">phidata</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">qdata</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="n">_np_</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ucol</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">vcol</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">_np_</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
        <span class="n">rdata</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ucol</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">vcol</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">wdata</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">rdata</span> <span class="o">=</span> <span class="n">rdata</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">rdata</span><span class="p">)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">hsl2rgb</span><span class="p">(</span><span class="n">qdata</span><span class="p">,</span> <span class="n">rdata</span><span class="p">,</span> <span class="n">phidata</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
        <span class="k">if</span> <span class="s">&quot;save_filename&quot;</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
            <span class="n">save</span> <span class="o">=</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;save_filename&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;save_filename&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">save</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># stop saving file twice</span>
            <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;save_filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiver_plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">ucol</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">vcol</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</div>
<div class="viewcode-block" id="PlotFile.plot_xyzuvw"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.plot_xyzuvw.html#Stoner.Plot.PlotFile.plot_xyzuvw">[docs]</a>    <span class="k">def</span> <span class="nf">plot_xyzuvw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ucol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots a vector field plot based on rows of X,Y,Z (U,V,W) data using ,ayavi.</span>

<span class="sd">            Args:</span>
<span class="sd">                xcol (index): Xcolumn index or label</span>
<span class="sd">                ycol (index): Y column index or label</span>
<span class="sd">                zcol (index): Z column index or label</span>
<span class="sd">                ucol (index): U column index or label</span>
<span class="sd">                vcol (index): V column index or label</span>
<span class="sd">                wcol (index): W column index or label</span>

<span class="sd">            Keyword Arguments:</span>
<span class="sd">                colormap (string): Vector field colour map - defaults to the jet colour map</span>
<span class="sd">                colors (column index or numpy array): Values used to map the colors of the resultant file.</span>
<span class="sd">                mode (string): glyph type, default is &quot;cone&quot;</span>
<span class="sd">                scale_factor(float): Scale-size of glyphs.</span>
<span class="sd">                figure (mlab figure): Controls what mlab figure to use. Can be an integer, or a mlab.figure or False. If False then a new figure is always used, otherwise it will default to using the last figure used by this DataFile object.</span>
<span class="sd">                plotter (callable): Optional arguement that passes a plotting function into the routine. Sensible choices might be plt.plot (default), py.semilogy, plt.semilogx</span>
<span class="sd">                kargs (dict): A dictionary of other keyword arguments to pass into the plot function.</span>

<span class="sd">            Returns:</span>
<span class="sd">                A mayavi scene instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">mayavi</span> <span class="kn">import</span> <span class="n">mlab</span><span class="p">,</span> <span class="n">core</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_cols</span><span class="p">(</span><span class="n">xcol</span><span class="o">=</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="n">ycol</span><span class="p">,</span> <span class="n">zcol</span><span class="o">=</span><span class="n">zcol</span><span class="p">,</span> <span class="n">ucol</span><span class="o">=</span><span class="n">ucol</span><span class="p">,</span> <span class="n">vcol</span><span class="o">=</span><span class="n">vcol</span><span class="p">,</span> <span class="n">wcol</span><span class="o">=</span><span class="n">wcol</span><span class="p">,</span> <span class="n">multi_y</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;figure&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span>
            <span class="s">&quot;plotter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_VectorFieldPlot</span><span class="p">,</span>
            <span class="s">&quot;show_plot&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">&quot;mode&quot;</span><span class="p">:</span> <span class="s">&quot;cone&quot;</span><span class="p">,</span>
            <span class="s">&quot;scale_factor&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s">&quot;colors&quot;</span><span class="p">:</span> <span class="bp">True</span>
        <span class="p">}</span>
        <span class="n">otherkargs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;color&quot;</span><span class="p">,</span> <span class="s">&quot;colormap&quot;</span><span class="p">,</span> <span class="s">&quot;extent&quot;</span><span class="p">,</span> <span class="s">&quot;figure&quot;</span><span class="p">,</span> <span class="s">&quot;line_width&quot;</span><span class="p">,</span> <span class="s">&quot;mask_points&quot;</span><span class="p">,</span> <span class="s">&quot;mode&quot;</span><span class="p">,</span> <span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;opacity&quot;</span><span class="p">,</span>
                      <span class="s">&quot;reset_zoom&quot;</span><span class="p">,</span> <span class="s">&quot;resolution&quot;</span><span class="p">,</span> <span class="s">&quot;scalars&quot;</span><span class="p">,</span> <span class="s">&quot;scale_factor&quot;</span><span class="p">,</span> <span class="s">&quot;scale_mode&quot;</span><span class="p">,</span> <span class="s">&quot;transparent&quot;</span><span class="p">,</span> <span class="s">&quot;vmax&quot;</span><span class="p">,</span>
                      <span class="s">&quot;vmin&quot;</span><span class="p">]</span>
        <span class="n">kargs</span><span class="p">,</span> <span class="n">nonkargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_kargs</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">otherkargs</span><span class="o">=</span><span class="n">otherkargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;colors&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">colors</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">index_types</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">_np_</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">colors</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">()])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Do not recognise what to do with the colors keyword.&quot;</span><span class="p">)</span>
        <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;scalars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>
        <span class="n">figure</span> <span class="o">=</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;figure&quot;</span><span class="p">]</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">figure</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">figure</span><span class="p">:</span>
            <span class="n">figure</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">Scene</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">Scene</span><span class="p">):</span>
            <span class="n">figure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">figure</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="n">kargs</span><span class="p">[</span><span class="s">&quot;figure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">figure</span>
        <span class="n">plotter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">xcol</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ycol</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">zcol</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ucol</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">vcol</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">wcol</span><span class="p">),</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;show_plot&quot;</span><span class="p">]:</span>
            <span class="n">mlab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span>
</div>
<div class="viewcode-block" id="PlotFile.quiver_plot"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.quiver_plot.html#Stoner.Plot.PlotFile.quiver_plot">[docs]</a>    <span class="k">def</span> <span class="nf">quiver_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ucol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vcol</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make a 2D Quiver plot from the data.</span>

<span class="sd">        Args:</span>
<span class="sd">            xcol (index): Xcolumn index or label</span>
<span class="sd">            ycol (index): Y column index or label</span>
<span class="sd">            zcol (index): Z column index or label</span>
<span class="sd">            ucol (index): U column index or label</span>
<span class="sd">            vcol (index): V column index or label</span>
<span class="sd">            wcol (index): W column index or label</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            xlabel (string) X axes label. Deafult is None - guess from xvals or metadata</span>
<span class="sd">            ylabel (string): Y axes label, Default is None - guess from metadata</span>
<span class="sd">            zlabel (string): Z axis label, Default is None - guess from metadata</span>
<span class="sd">            plotter (function): Function to use to plot data. Defaults to plt.contour</span>
<span class="sd">            headlength,headwidth,headaxislength (float): Controls the size of the quiver heads</span>
<span class="sd">            show_plot (bool): Turn on interfactive plotting and show plot when drawn</span>
<span class="sd">            save_filename (string or None): If set to a string, save the plot with this filename</span>
<span class="sd">            figure (integer or matplotlib.figure or boolean): Controls which figure is used for the plot, or if a new figure is opened.</span>
<span class="sd">            **kargs (dict): Other arguments are passed on to the plotter.</span>


<span class="sd">        Returns:</span>
<span class="sd">            A matplotlib figure instance.</span>

<span class="sd">        Keyword arguments are all passed through to :py:func:`matplotlib.plt.quiver`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fix_cols</span><span class="p">(</span><span class="n">xcol</span><span class="o">=</span><span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="o">=</span><span class="n">ycol</span><span class="p">,</span> <span class="n">ucol</span><span class="o">=</span><span class="n">ucol</span><span class="p">,</span> <span class="n">vcol</span><span class="o">=</span><span class="n">vcol</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">))</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;pivot&quot;</span><span class="p">:</span> <span class="s">&quot;center&quot;</span><span class="p">,</span>
            <span class="s">&quot;color&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
            <span class="s">&quot;headlength&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s">&quot;headaxislength&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s">&quot;headwidth&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s">&quot;units&quot;</span><span class="p">:</span> <span class="s">&quot;xy&quot;</span><span class="p">,</span>
            <span class="s">&quot;plotter&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">,</span>
            <span class="s">&quot;show_plot&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">&quot;figure&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
            <span class="s">&quot;xlabel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">xcol</span><span class="p">)),</span>
            <span class="s">&quot;ylabel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">ycol</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="n">otherkargs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;units&quot;</span><span class="p">,</span> <span class="s">&quot;angles&quot;</span><span class="p">,</span> <span class="s">&quot;scale&quot;</span><span class="p">,</span> <span class="s">&quot;scale_units&quot;</span><span class="p">,</span> <span class="s">&quot;width&quot;</span><span class="p">,</span> <span class="s">&quot;headwidth&quot;</span><span class="p">,</span> <span class="s">&quot;headlength&quot;</span><span class="p">,</span> <span class="s">&quot;headaxislength&quot;</span><span class="p">,</span>
                      <span class="s">&quot;minshaft&quot;</span><span class="p">,</span> <span class="s">&quot;minlength&quot;</span><span class="p">,</span> <span class="s">&quot;pivot&quot;</span><span class="p">,</span> <span class="s">&quot;color&quot;</span><span class="p">]</span>
        <span class="n">kargs</span><span class="p">,</span> <span class="n">nonkargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_kargs</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">otherkargs</span><span class="o">=</span><span class="n">otherkargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;plotter&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_fig</span><span class="p">(</span><span class="n">nonkargs</span><span class="p">[</span><span class="s">&quot;figure&quot;</span><span class="p">])</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plotter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">xcol</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">ycol</span><span class="p">)),</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">ucol</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">vcol</span><span class="p">)),</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fix_titles</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;non&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">nonkargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>
</div>
<div class="viewcode-block" id="PlotFile.subplot"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.subplot.html#Stoner.Plot.PlotFile.subplot">[docs]</a>    <span class="k">def</span> <span class="nf">subplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pass throuygh for plt.subplot().</span>

<span class="sd">        Args:</span>
<span class="sd">            rows (int): If this is the only argument, then a three digit number representing</span>
<span class="sd">                the rows,columns,index arguments. If seperate rows, column and index are provided,</span>
<span class="sd">                then this is the number of rows of sub-plots in one figure.</span>
<span class="sd">            columns (int): The number of columns of sub-plots in one figure.</span>
<span class="sd">            index (int): Index (1 based) of the current sub-plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A matplotlib.Axes instance representing the current sub-plot</span>

<span class="sd">        As well as passing through to the plyplot routine of the same name, this</span>
<span class="sd">        function maintains a list of the current sub-plot axes via the subplots attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">new_figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">100</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">%</span> <span class="mi">10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subplots</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subplots</span><span class="p">))])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subplots</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span>
        <span class="k">return</span> <span class="n">sp</span>
</div>
<div class="viewcode-block" id="PlotFile.x2"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.x2.html#Stoner.Plot.PlotFile.x2">[docs]</a>    <span class="k">def</span> <span class="nf">x2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate a new set of axes with a second x-scale.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The new matplotlib.axes instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax2</span>
</div>
<div class="viewcode-block" id="PlotFile.y2"><a class="viewcode-back" href="../../classes/Stoner.Plot.PlotFile.y2.html#Stoner.Plot.PlotFile.y2">[docs]</a>    <span class="k">def</span> <span class="nf">y2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate a new set of axes with a second y-scale.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The new matplotlib.axes instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__figure</span><span class="o">.</span><span class="n">subplotpars</span><span class="o">.</span><span class="n">right</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax2</span>

</div></div>
<div class="viewcode-block" id="hsl2rgb"><a class="viewcode-back" href="../../classes/Stoner.Plot.hsl2rgb.html#Stoner.Plot.hsl2rgb">[docs]</a><span class="k">def</span> <span class="nf">hsl2rgb</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts from hsl colourspace to rgb colour space with numpy arrays for speed.</span>

<span class="sd">    Args:</span>
<span class="sd">        h (array): Hue value</span>
<span class="sd">        s (array): Saturation value</span>
<span class="sd">        l (array): Luminence value</span>

<span class="sd">    Returns:</span>
<span class="sd">        2D array (Mx3) of unsigned 8bit integers</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">where</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">h</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">l</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">l</span><span class="o">.</span><span class="n">shape</span> <span class="ow">or</span> <span class="n">h</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Must have equal shaped arrays for h, s and l&quot;</span><span class="p">)</span>

    <span class="n">rgb</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">hls</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)):</span>
        <span class="n">rgb</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">_np_</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hls_to_rgb</span><span class="p">(</span><span class="o">*</span><span class="n">hls</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">rgb</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;u1&#39;</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/StonerLogo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Stoner Package</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Gavin Burnell et al.
      Last updated on Jul 22, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>