<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Stoner.pyTDMS &mdash; Stoner Pacakge API Documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Stoner Pacakge API Documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Stoner Package</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for Stoner.pyTDMS</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;pyTDMS: Standalone Python TDMS reader,</span>

<span class="sd">based on the format description on</span>
<span class="sd">http://zone.ni.com/devzone/cda/tut/p/id/5696</span>

<span class="sd">Floris van Vugt</span>
<span class="sd">IMMM Hannover</span>
<span class="sd">http://florisvanvugt.free.fr/</span>

<span class="sd">Updated with Python3 tweaks by Gavin Burnell</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">Stoner.compat</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c"># Tells us whether we should really output messages about what</span>
<span class="c"># we have read (clutters the output buffer though)</span>
<span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span>


<div class="viewcode-block" id="byteToHex"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.byteToHex.html#Stoner.pyTDMS.byteToHex">[docs]</a><span class="k">def</span> <span class="nf">byteToHex</span><span class="p">(</span><span class="n">byteStr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a byte string to it&#39;s hex string representation e.g. for output.</span>

<span class="sd">    Args:</span>
<span class="sd">        byteStr (string): Input string of bytes</span>

<span class="sd">    Note:</span>
<span class="sd">        Uses list comprehension which is a fractionally faster implementation than</span>
<span class="sd">        the alternative, more readable, implementation below::</span>
<span class="sd">        hex = []</span>
<span class="sd">        for aChar in byteStr:</span>
<span class="sd">            hex.append( &quot;%02X &quot; % ord( aChar ) )</span>
<span class="sd">        return &#39;&#39;.join( hex ).strip()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&quot;</span><span class="si">%02X</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">byteStr</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

</div>
<span class="k">if</span> <span class="n">python_v3</span><span class="p">:</span>
    <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">one</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;1L&quot;</span><span class="p">)</span>

<span class="n">tocProperties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;kTocMetaData&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s">&#39;kTocRawData&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">),</span>
    <span class="s">&#39;kTocDAQmxRawData&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">),</span>
    <span class="s">&#39;kTocInterleavedData&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">),</span>
    <span class="s">&#39;kTocBigEndian&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">),</span>
    <span class="s">&#39;kTocNewObjList&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">tdsDataTypes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;tdsTypeVoid&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeI8&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeI16&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeI32&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeI64&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeU8&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeU16&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeU32&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeU64&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeSingleFloat&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeDoubleFloat&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeExtendedFloat&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeSingleFloatWithUnit&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeDoubleFloatWithUnit&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeExtendedFloatWithUnit&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeString&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeBoolean&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeTimeStamp&#39;</span><span class="p">,</span>
                <span class="s">&#39;tdsTypeDAQmxRawData&#39;</span><span class="p">,</span> <span class="p">]</span>

<span class="n">tdsDataTypesDefined</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mh">0x19</span><span class="p">:</span> <span class="s">&#39;tdsTypeSingleFloatWithUnit&#39;</span><span class="p">,</span>
    <span class="mh">0x20</span><span class="p">:</span> <span class="s">&#39;tdsTypeString&#39;</span><span class="p">,</span>
    <span class="mh">0x21</span><span class="p">:</span> <span class="s">&#39;tdsTypeBoolean&#39;</span><span class="p">,</span>
    <span class="mh">0x44</span><span class="p">:</span> <span class="s">&#39;tdsTypeTimeStamp&#39;</span><span class="p">,</span>
    <span class="mh">0xFFFFFFFF</span><span class="p">:</span> <span class="s">&#39;tdsTypeDAQmxRawData&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">tdsDataTypesTranscriptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;tdsTypeVoid&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeI8&#39;</span><span class="p">:</span> <span class="s">&#39;b&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeI16&#39;</span><span class="p">:</span> <span class="s">&#39;i&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeI32&#39;</span><span class="p">:</span> <span class="s">&#39;l&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeI64&#39;</span><span class="p">:</span> <span class="s">&#39;q&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeU8&#39;</span><span class="p">:</span> <span class="s">&#39;B&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeU16&#39;</span><span class="p">:</span> <span class="s">&#39;I&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeU32&#39;</span><span class="p">:</span> <span class="s">&#39;L&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeU64&#39;</span><span class="p">:</span> <span class="s">&#39;Q&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeSingleFloat&#39;</span><span class="p">:</span> <span class="s">&#39;f&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeDoubleFloat&#39;</span><span class="p">:</span> <span class="s">&#39;d&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeExtendedFloat&#39;</span><span class="p">:</span> <span class="s">&#39; &#39;</span><span class="p">,</span>  <span class="c">#NOT YET IMPLEMENTED</span>
    <span class="s">&#39;tdsTypeSingleFloatWithUnit&#39;</span><span class="p">:</span> <span class="s">&#39; &#39;</span><span class="p">,</span>  <span class="c">#NOT YET IMPLEMENTED</span>
    <span class="s">&#39;tdsTypeDoubleFloatWithUnit&#39;</span><span class="p">:</span> <span class="s">&#39; &#39;</span><span class="p">,</span>  <span class="c">#NOT YET IMPLEMENTED</span>
    <span class="s">&#39;tdsTypeExtendedFloatWithUnit&#39;</span><span class="p">:</span> <span class="s">&#39; &#39;</span><span class="p">,</span>  <span class="c">#NOT YET IMPLEMENTED</span>
    <span class="s">&#39;tdsTypeString&#39;</span><span class="p">:</span> <span class="s">&#39; &#39;</span><span class="p">,</span>  <span class="c"># SHOULD BE HANDLED SEPARATELY</span>
    <span class="s">&#39;tdsTypeBoolean&#39;</span><span class="p">:</span> <span class="s">&#39;b&#39;</span><span class="p">,</span>
    <span class="s">&#39;tdsTypeTimeStamp&#39;</span><span class="p">:</span> <span class="s">&#39; &#39;</span><span class="p">,</span>  <span class="c"># SHOULD BE HANDLED SEPARATELY</span>
    <span class="s">&#39;tdsTypeDAQmxRawData&#39;</span><span class="p">:</span> <span class="s">&#39; &#39;</span><span class="p">,</span>  <span class="c"># SHOULD BE HANDLED SEPARATELY</span>
<span class="p">}</span>


<div class="viewcode-block" id="dataTypeFrom"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.dataTypeFrom.html#Stoner.pyTDMS.dataTypeFrom">[docs]</a><span class="k">def</span> <span class="nf">dataTypeFrom</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find back the data type from raw input data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">tdsDataTypesDefined</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tdsDataTypesDefined</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tdsDataTypes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="dataTypeLength"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.dataTypeLength.html#Stoner.pyTDMS.dataTypeLength">[docs]</a><span class="k">def</span> <span class="nf">dataTypeLength</span><span class="p">(</span><span class="n">datatype</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;How many bytes we need to read to read in an object of the given datatype</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;tdsTypeVoid&#39;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;tdsTypeI8&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeU8&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeBoolean&#39;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;tdsTypeI16&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeU16&#39;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;tdsTypeI32&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeU32&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeSingleFloat&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeSingleFloatWithUnit&#39;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">4</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;tdsTypeI64&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeU64&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeDoubleFloat&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeDoubleFloatWithUnit&#39;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">8</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;tdsTypeTimeStamp&#39;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">16</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;tdsTypeString&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeExtendedFloat&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeExtendedFloatWithUnit&#39;</span><span class="p">,</span> <span class="s">&#39;tdsTypeDAQmxRawData&#39;</span><span class="p">,</span> <span class="p">]):</span>
        <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="dataTypeTranscription"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.dataTypeTranscription.html#Stoner.pyTDMS.dataTypeTranscription">[docs]</a><span class="k">def</span> <span class="nf">dataTypeTranscription</span><span class="p">(</span><span class="n">datatype</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the identifier for the given datatype hat we need to feed into struct.unpack to get the right thing out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tdsDataTypesTranscriptions</span><span class="p">[</span><span class="n">datatype</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="getValue"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.getValue.html#Stoner.pyTDMS.getValue">[docs]</a><span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">endianness</span><span class="p">,</span> <span class="n">datatype</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;We just read s from the file, and now we need to unpack it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">datatype</span> <span class="o">==</span> <span class="s">&#39;tdsTypeTimeStamp&#39;</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">str2bytes</span><span class="p">(</span><span class="n">endianness</span> <span class="o">+</span> <span class="s">&quot;Qq&quot;</span><span class="p">),</span> <span class="n">s</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="c"># the number of seconds since the 1904 epoch</span>
                <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="o">-</span><span class="mi">64</span><span class="p">)</span>  <span class="c"># plus the number of 2^-64 seconds</span>
               <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">endianness</span> <span class="o">+</span> <span class="n">dataTypeTranscription</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">str2bytes</span><span class="p">(</span><span class="n">code</span><span class="p">),</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="readLeadIn"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.readLeadIn.html#Stoner.pyTDMS.readLeadIn">[docs]</a><span class="k">def</span> <span class="nf">readLeadIn</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read the lead-in of a segment</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c"># read 4 bytes</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="n">b</span><span class="s">&#39;TDSm&#39;</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Error: segment does not start with TDSm, but with {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">toc</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;i&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">tocProperties</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">metadata</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">toc</span> <span class="o">&amp;</span> <span class="n">tocProperties</span><span class="p">[</span><span class="n">prop</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span>

<span class="c">#print (&quot;TOC: &quot;+toc)</span>
<span class="c"># Contents type (bit mask not yet decoded)</span>

<span class="c"># The version number</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">version</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;i&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
    <span class="p">(</span><span class="n">next_segment_offset</span><span class="p">,</span> <span class="n">raw_data_offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;QQ&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="c">#print (&quot;Length remaining: &quot;+str(length_remaining))</span>

    <span class="c">#print (&quot;Length meta: &quot;+str(length_meta))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">next_segment_offset</span><span class="p">,</span> <span class="n">raw_data_offset</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="readObject"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.readObject.html#Stoner.pyTDMS.readObject">[docs]</a><span class="k">def</span> <span class="nf">readObject</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read object in the metadata array</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># Read the object path</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">lnth</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">objectpath</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">lnth</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">rawdataindex</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># No raw data associated</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">rawdataindex</span> <span class="o">==</span> <span class="mh">0xFFFFFFFF</span><span class="p">):</span>
        <span class="n">rawdata</span> <span class="o">=</span> <span class="p">()</span>

<span class="c"># Raw data index same as before</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">rawdataindex</span> <span class="o">==</span> <span class="mh">0x00000000</span><span class="p">):</span>
        <span class="n">rawdata</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="c">#print &quot;==&gt;Raw data reading&quot;,byteToHex(s),&quot;,that is,&quot;,rawdataindex,&quot;bytes&quot;</span>

        <span class="c">#s = f.read(rawdataindex)</span>

        <span class="c"># New raw data index!</span>

        <span class="n">inf_length</span> <span class="o">=</span> <span class="n">rawdataindex</span>

        <span class="c"># DataType</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">rawdata_datatype</span> <span class="o">=</span> <span class="n">dataTypeFrom</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="c"># Dimension of the raw data array</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="c">#print &quot;Dimension: &quot;,byteToHex(s)</span>
        <span class="n">rawdata_dim</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c"># Number of raw data values</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">rawdata_values</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;Q&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">rawdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">rawdata_datatype</span><span class="p">,</span> <span class="n">rawdata_dim</span><span class="p">,</span> <span class="n">rawdata_values</span><span class="p">)</span>

<span class="c">#print &quot;==&gt;Done reading raw data:&quot;,rawdata</span>

<span class="c"># Read the number of properties</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">nProp</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c">#print &quot;Has&quot;,nProp,&quot;properties&quot;</span>

    <span class="n">properties</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nProp</span><span class="p">):</span>

        <span class="c">#print &quot;Property&quot;,j</span>
        <span class="c"># Read one property</span>

        <span class="c"># Read the property name</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">numb</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">numb</span><span class="p">)</span>
        <span class="c">#print name</span>

        <span class="c"># Read the data type</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="c">#print &quot;Data type&quot;,s,byteToHex(s)</span>
        <span class="n">datatype</span> <span class="o">=</span> <span class="n">dataTypeFrom</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

        <span class="c"># If it&#39;s a string, read the length</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="o">==</span> <span class="s">&#39;tdsTypeString&#39;</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">lengte</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">lengte</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">nm</span> <span class="o">=</span> <span class="n">dataTypeLength</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>

            <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">nm</span><span class="p">,</span> <span class="s">&quot;Failed to read correct number of bytes {} vs {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">nm</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">getValue</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span>

        <span class="n">properties</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">objectpath</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="n">rawdata</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="mergeProperties"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.mergeProperties.html#Stoner.pyTDMS.mergeProperties">[docs]</a><span class="k">def</span> <span class="nf">mergeProperties</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">newprop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Merge the two property lists, using the newprop list to overwrite if conflicts arise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># What we will return</span>
    <span class="n">retprop</span> <span class="o">=</span> <span class="n">prop</span>

    <span class="c"># Now we change the values wherever we need to</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">newprop</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">retprop</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">newprop</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

<span class="c"># And the return the merged list</span>
    <span class="k">return</span> <span class="n">retprop</span>

</div>
<div class="viewcode-block" id="mergeObject"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.mergeObject.html#Stoner.pyTDMS.mergeObject">[docs]</a><span class="k">def</span> <span class="nf">mergeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">newobj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ok, we are given two objects: obj and alt. We make all the changes (new values or overwriting old values), taking newobj as dominant.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="p">(</span><span class="n">objectpath</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="n">rawdata</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="p">(</span><span class="n">newobjectpath</span><span class="p">,</span> <span class="n">newrawdataindex</span><span class="p">,</span> <span class="n">newrawdata</span><span class="p">,</span> <span class="n">newproperties</span><span class="p">)</span> <span class="o">=</span> <span class="n">newobj</span>

    <span class="c"># We assume that objectpath is the same</span>
    <span class="k">assert</span> <span class="n">newobjectpath</span> <span class="o">==</span> <span class="n">objectpath</span><span class="p">,</span> <span class="s">&quot;Error: trying to merge non-same objectpaths:{} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">newobjectpath</span><span class="p">,</span>
                                                                                                   <span class="n">objectpath</span><span class="p">)</span>

    <span class="c"># If there is some change in the raw data associated</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="n">newrawdataindex</span> <span class="ow">in</span> <span class="p">[</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">])):</span>
        <span class="n">retrawdataindex</span> <span class="o">=</span> <span class="n">newrawdataindex</span>
        <span class="n">retrawdata</span> <span class="o">=</span> <span class="n">newrawdata</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">retrawdataindex</span> <span class="o">=</span> <span class="n">rawdataindex</span>
        <span class="n">retrawdata</span> <span class="o">=</span> <span class="n">rawdata</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">objectpath</span><span class="p">,</span> <span class="n">retrawdataindex</span><span class="p">,</span> <span class="n">retrawdata</span><span class="p">,</span> <span class="n">mergeProperties</span><span class="p">(</span><span class="n">properties</span><span class="p">,</span> <span class="n">newproperties</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="mergeObjects"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.mergeObjects.html#Stoner.pyTDMS.mergeObjects">[docs]</a><span class="k">def</span> <span class="nf">mergeObjects</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">newobjects</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the objects (metadata), but add the stuff that is in newobjects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">retobjects</span> <span class="o">=</span> <span class="n">objects</span>

    <span class="c"># For all the new objects...</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">newobjects</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

        <span class="c"># See if there is an old version already</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span> <span class="ow">in</span> <span class="n">retobjects</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>

            <span class="c"># Then update the old version using the new information</span>
            <span class="n">retobjects</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">mergeObject</span><span class="p">(</span><span class="n">retobjects</span><span class="p">[</span><span class="n">obj</span><span class="p">],</span> <span class="n">newobjects</span><span class="p">[</span><span class="n">obj</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c"># Else just add it anew</span>
            <span class="n">retobjects</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">newobjects</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">retobjects</span>

</div>
<div class="viewcode-block" id="readMetaData"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.readMetaData.html#Stoner.pyTDMS.readMetaData">[docs]</a><span class="k">def</span> <span class="nf">readMetaData</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read meta data from file f.</span>

<span class="sd">    Args:</span>
<span class="sd">        f (file): Input file</span>

<span class="sd">    Returns:</span>
<span class="sd">        (objects,objectorder) where objects is the structure containing all information about</span>
<span class="sd">            objects, and objectorder is a list of objectpaths (object ID&#39;s if you want)</span>
<span class="sd">            in the order that they have been presented. We need this</span>
<span class="sd">            later when we start reading the raw data, since it then comes</span>
<span class="sd">            in this very order.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># The number of objects in this metadata</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">nObjects</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;&lt;l&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">objects</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">objectorder</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nObjects</span><span class="p">):</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">readObject</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="p">(</span><span class="n">objectpath</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="n">rawdata</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span> <span class="o">=</span> <span class="n">obj</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Read object&quot;</span><span class="p">,</span> <span class="n">objectpath</span><span class="p">)</span>

<span class="c"># Add this object, or, if an object with the same objectpath</span>
<span class="c"># exists already, make it update that one.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">objectpath</span> <span class="ow">in</span> <span class="n">objects</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">objects</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">objectpath</span><span class="p">)]</span> <span class="o">=</span> <span class="n">mergeObjects</span><span class="p">(</span><span class="n">objects</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">objectpath</span><span class="p">)],</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># We add it anew</span>
            <span class="n">objects</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">objectpath</span><span class="p">)]</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="n">objectorder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">objectpath</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">objectorder</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="isChannel"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.isChannel.html#Stoner.pyTDMS.isChannel">[docs]</a><span class="k">def</span> <span class="nf">isChannel</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tell us whether the given object is a channel (in the current segment) and if so, returns the meta information about the raw data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">return</span> <span class="n">rawdataindex</span> <span class="o">!=</span> <span class="mh">0xFFFFFFFF</span>

</div>
<div class="viewcode-block" id="readRawData"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.readRawData.html#Stoner.pyTDMS.readRawData">[docs]</a><span class="k">def</span> <span class="nf">readRawData</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">leadin</span><span class="p">,</span> <span class="n">segmentobjects</span><span class="p">,</span> <span class="n">objectorder</span><span class="p">,</span> <span class="n">filesize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read raw data from file f, given the previously read leadin.</span>

<span class="sd">    Args:</span>
<span class="sd">        f (file): Input file</span>
<span class="sd">        leadin (string): Data already read in from file</span>
<span class="sd">        segmentobjects (LIST): are the objects that are given in this segment.</span>
<span class="sd">        Objectorder )LIST): is a list of objectpaths (object id&#39;s) that shows</span>
<span class="sd">            the order in which the objects are given in the metadata.</span>
<span class="sd">            That is important, for that will be the order in which their</span>
<span class="sd">            raw data needs to be read.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">next_segment_offset</span><span class="p">,</span> <span class="n">raw_data_offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">leadin</span>

    <span class="c"># Whether the channel data is interleaved</span>
    <span class="n">interleaved</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s">&quot;kTocInterleavedData&quot;</span><span class="p">]</span>

    <span class="c"># Set the correct endianness (still need to check this!)</span>
    <span class="n">endianness</span> <span class="o">=</span> <span class="s">&#39;&lt;&#39;</span>
    <span class="k">if</span> <span class="n">metadata</span><span class="p">[</span><span class="s">&#39;kTocBigEndian&#39;</span><span class="p">]:</span> <span class="n">endianness</span> <span class="o">=</span> <span class="s">&#39;&gt;&#39;</span>

    <span class="c"># First see which objects are channels (or really</span>
    <span class="c"># actually which objects are channels AND have data in this segment.</span>
    <span class="n">channel_sizes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectorder</span> <span class="k">if</span> <span class="n">isChannel</span><span class="p">(</span><span class="n">segmentobjects</span><span class="p">[</span><span class="n">obj</span><span class="p">])]</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="n">segmentobjects</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>

        <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="n">rawdata</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span> <span class="o">=</span> <span class="n">channel</span>

        <span class="p">(</span><span class="n">rawdata_datatype</span><span class="p">,</span> <span class="n">rawdata_dim</span><span class="p">,</span> <span class="n">rawdata_values</span><span class="p">)</span> <span class="o">=</span> <span class="n">rawdata</span>

        <span class="k">assert</span> <span class="p">(</span><span class="n">rawdata_dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="s">&quot;Error! Raw data dimension is {} and should have been 1.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rawdata_dim</span><span class="p">)</span>

        <span class="c"># Calculate how many bytes a single value is</span>
        <span class="n">datapointsize</span> <span class="o">=</span> <span class="n">dataTypeLength</span><span class="p">(</span><span class="n">rawdata_datatype</span><span class="p">)</span>

        <span class="c"># Array dimension (should really be 1)</span>
        <span class="n">channel_size</span> <span class="o">=</span> <span class="n">datapointsize</span> <span class="o">*</span> <span class="n">rawdata_dim</span> <span class="o">*</span> <span class="n">rawdata_values</span>

        <span class="n">channel_sizes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_size</span>

<span class="c"># How much data in all channels together</span>
    <span class="n">chunk_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">channel_sizes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">])</span>

    <span class="c"># A correction given on the TDMS specification website</span>
    <span class="k">if</span> <span class="n">next_segment_offset</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">next_segment_offset</span> <span class="o">=</span> <span class="n">filesize</span>

<span class="c"># Raw data size of total chunks</span>
<span class="c"># (next_segment_offset should already have been corrected if -1)</span>
    <span class="n">total_chunks</span> <span class="o">=</span> <span class="n">next_segment_offset</span> <span class="o">-</span> <span class="n">raw_data_offset</span>
    <span class="c"># Hm, I think this quantity should be the total data</span>
    <span class="c"># in this segment.</span>

    <span class="n">n_chunks</span> <span class="o">=</span> <span class="n">total_chunks</span> <span class="o">/</span> <span class="n">chunk_size</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Ready for reading&quot;</span><span class="p">,</span> <span class="n">total_chunks</span><span class="p">,</span> <span class="s">&quot;bytes (&quot;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">,</span> <span class="s">&quot;) in&quot;</span><span class="p">,</span> <span class="n">n_chunks</span><span class="p">,</span> <span class="s">&quot;chunks&quot;</span><span class="p">,</span> <span class="p">)</span>

    <span class="k">if</span> <span class="n">interleaved</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot; ==&gt; Interleaved&quot;</span><span class="p">)</span>

<span class="c"># Initialise data to be empty</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channel</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">chunk_size</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channel</span><span class="p">:</span>
                <span class="n">channel</span> <span class="o">=</span> <span class="n">segmentobjects</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>

                <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">rawdata_dim</span><span class="p">,</span> <span class="n">rawdata_values</span><span class="p">),</span> <span class="n">values</span><span class="p">)</span> <span class="o">=</span> <span class="n">channel</span>

                <span class="c"># Calculate how many bytes a single value is</span>
                <span class="n">datapointsize</span> <span class="o">=</span> <span class="n">dataTypeLength</span><span class="p">(</span><span class="n">rawdata_datatype</span><span class="p">)</span>

                <span class="c"># Read one value from the file</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">datapointsize</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">getValue</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">endianness</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span>

                <span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot; ==&gt; Not Interleaved&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">channel_sizes</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>

            <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">rawdata_dim</span><span class="p">,</span> <span class="n">rawdata_values</span><span class="p">),</span> <span class="n">values</span><span class="p">)</span> <span class="o">=</span> <span class="n">channel</span>

            <span class="c"># Calculate how many bytes a single value is</span>
            <span class="n">datapointsize</span> <span class="o">=</span> <span class="n">dataTypeLength</span><span class="p">(</span><span class="n">datatype</span><span class="p">)</span>

            <span class="c"># Start with no data in our channel</span>
            <span class="n">channelData</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rawdata_values</span><span class="p">):</span>

                <span class="c"># Read one value from the file</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">datapointsize</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">getValue</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">endianness</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span>
                <span class="n">channelData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">channelData</span>

    <span class="k">return</span> <span class="n">data</span>

</div>
<div class="viewcode-block" id="mergeRawData"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.mergeRawData.html#Stoner.pyTDMS.mergeRawData">[docs]</a><span class="k">def</span> <span class="nf">mergeRawData</span><span class="p">(</span><span class="n">rawdata</span><span class="p">,</span> <span class="n">newrawdata</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the raw data, appended the new raw data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">newrawdata</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

        <span class="c"># If we already had data on this channel</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="ow">in</span> <span class="n">rawdata</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">rawdata</span><span class="p">[</span><span class="n">channel</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">newrawdata</span><span class="p">[</span><span class="n">channel</span><span class="p">])</span>

<span class="c"># Else we just chart it annew</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rawdata</span><span class="p">[</span><span class="n">channel</span><span class="p">]</span> <span class="o">=</span> <span class="n">newrawdata</span><span class="p">[</span><span class="n">channel</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rawdata</span>

</div>
<div class="viewcode-block" id="readSegment"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.readSegment.html#Stoner.pyTDMS.readSegment">[docs]</a><span class="k">def</span> <span class="nf">readSegment</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">filesize</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read a segment from file f, whose filesize is given, and data is what we have read already</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># This is the data we have so far.</span>
    <span class="c"># The stuff in this segment is going to append to this.</span>
    <span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">rawdata</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span>

    <span class="n">leadin</span> <span class="o">=</span> <span class="n">readLeadIn</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">next_segment_offset</span><span class="p">,</span> <span class="n">raw_data_offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">leadin</span>

    <span class="n">newobjects</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c"># If the segment has metadata...</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s">&quot;kTocMetaData&quot;</span><span class="p">]):</span>

        <span class="c"># Read the meta data</span>
        <span class="p">(</span><span class="n">newobjects</span><span class="p">,</span> <span class="n">newobjectorder</span><span class="p">)</span> <span class="o">=</span> <span class="n">readMetaData</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c"># Merge the new information with what we knew already about the objects.</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="n">mergeObjects</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">newobjects</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s">&quot;kTocRawData&quot;</span><span class="p">]):</span>

        <span class="c"># Read the raw data</span>
        <span class="n">newdata</span> <span class="o">=</span> <span class="n">readRawData</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">leadin</span><span class="p">,</span> <span class="n">newobjects</span><span class="p">,</span> <span class="n">newobjectorder</span><span class="p">,</span> <span class="n">filesize</span><span class="p">)</span>

        <span class="c"># And merge the data we just read with what we knew already</span>
        <span class="n">rawdata</span> <span class="o">=</span> <span class="n">mergeRawData</span><span class="p">(</span><span class="n">rawdata</span><span class="p">,</span> <span class="n">newdata</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">rawdata</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="dumpProperties"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.dumpProperties.html#Stoner.pyTDMS.dumpProperties">[docs]</a><span class="k">def</span> <span class="nf">dumpProperties</span><span class="p">(</span><span class="n">props</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
        <span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="n">pr</span><span class="p">]</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span> <span class="o">+</span> <span class="p">(</span><span class="n">pr</span> <span class="o">+</span> <span class="s">&#39;=&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span>
    <span class="k">return</span> <span class="n">ret</span>

</div>
<div class="viewcode-block" id="csvDump"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.csvDump.html#Stoner.pyTDMS.csvDump">[docs]</a><span class="k">def</span> <span class="nf">csvDump</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dump the (objects,rawdata) that we read from a TDMS file straight into a CSV file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="o">=</span> <span class="n">args</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

        <span class="c"># Objects</span>
        <span class="p">(</span><span class="n">objectpath</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="n">rawdata</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span> <span class="o">=</span> <span class="n">objects</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot;OBJECT &quot;</span> <span class="o">+</span> <span class="n">objectpath</span> <span class="o">+</span> <span class="s">&quot; (&quot;</span> <span class="o">+</span> <span class="n">dumpProperties</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="c"># ret = ret + &#39;&#39;</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">maxi</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">obj</span><span class="p">])</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>

    <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">isChannel</span><span class="p">(</span><span class="n">objects</span><span class="p">[</span><span class="n">obj</span><span class="p">])]</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxi</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>

            <span class="n">val</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">obj</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">obj</span><span class="p">])):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="c"># The raw data associated with the object</span>

            <span class="n">ret</span> <span class="o">+=</span> <span class="n">val</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span>

        <span class="n">ret</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>

    <span class="k">return</span> <span class="n">ret</span>

</div>
<div class="viewcode-block" id="addTimeTrack"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.addTimeTrack.html#Stoner.pyTDMS.addTimeTrack">[docs]</a><span class="k">def</span> <span class="nf">addTimeTrack</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">channel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ok, so we&#39;ve read the data. Now it&#39;s possible that we require some post-processing. For example, if at least one track has time-data set, we&#39;ll add a corresponding time vector.</span>

<span class="sd">    So channel is the channel for which we want to have the time vector.</span>
<span class="sd">    And object contains its meta data.</span>

<span class="sd">    We return False if we can&#39;t find time data</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># Now check for each object whether it has</span>
    <span class="p">(</span><span class="n">objectpath</span><span class="p">,</span> <span class="n">rawdataindex</span><span class="p">,</span> <span class="n">rawdata</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="k">if</span> <span class="p">(</span>  <span class="c"># If we have time-data for this track</span>
        <span class="s">&#39;wf_increment&#39;</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s">&#39;wf_start_offset&#39;</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>

        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">incr</span><span class="p">)</span> <span class="o">=</span> <span class="n">properties</span><span class="p">[</span><span class="s">&#39;wf_increment&#39;</span><span class="p">]</span>
        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">properties</span><span class="p">[</span><span class="s">&#39;wf_start_offset&#39;</span><span class="p">]</span>

        <span class="c"># Then build the time track</span>
        <span class="n">timetrack</span> <span class="o">=</span> <span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">incr</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel</span><span class="p">))]</span>
        <span class="k">return</span> <span class="n">timetrack</span>

<span class="c"># Else we can&#39;t find time data</span>
    <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="read"><a class="viewcode-back" href="../../functions/Stoner.pyTDMS.read.html#Stoner.pyTDMS.read">[docs]</a><span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reads TDMS file with the given filename.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename(string): File to read</span>

<span class="sd">    Returns:</span>
<span class="sd">    We return the data, which is, object meta data and raw channel data.</span>

<span class="sd">    Note:</span>
<span class="sd">        Notice that we do not read the (optionally) accompanying .tdms_index</span>
<span class="sd">        since it is supposed to be an exact copy of the .tdms file, without the</span>
<span class="sd">        raw data. So it should contain nothing new.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># We start with empty data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">({},</span> <span class="p">{})</span>

    <span class="c"># Then we read the data from a file, and return that</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span>  <span class="c"># Open in binary mode for portability</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c"># While there&#39;s still something left to read</span>
    <span class="k">while</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">sz</span><span class="p">:</span>

        <span class="c"># Now we read segment by segment</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">readSegment</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/StonerLogo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Stoner Package</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Gavin Burnell et al.
      Last updated on May 05, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>