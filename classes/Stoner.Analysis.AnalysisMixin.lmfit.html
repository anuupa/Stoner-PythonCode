<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>AnalysisMixin.lmfit &#8212; Stoner Pacakge API Documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="AnalysisMixin.make_bins" href="Stoner.Analysis.AnalysisMixin.make_bins.html" />
    <link rel="prev" title="AnalysisMixin.interpolate" href="Stoner.Analysis.AnalysisMixin.interpolate.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Stoner.Analysis.AnalysisMixin.make_bins.html" title="AnalysisMixin.make_bins"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Stoner.Analysis.AnalysisMixin.interpolate.html" title="AnalysisMixin.interpolate"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Stoner Package</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../Stoner.html" >Stoner Package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="Stoner.Analysis.AnalysisMixin.html" accesskey="U">Stoner.Analysis.AnalysisMixin</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="analysismixin-lmfit">
<h1>AnalysisMixin.lmfit<a class="headerlink" href="#analysismixin-lmfit" title="Permalink to this headline">¶</a></h1>
<dl class="method">
<dt id="Stoner.Analysis.AnalysisMixin.lmfit">
<code class="descclassname">AnalysisMixin.</code><code class="descname">lmfit</code><span class="sig-paren">(</span><em>model</em>, <em>xcol=None</em>, <em>ycol=None</em>, <em>p0=None</em>, <em>sigma=None</em>, <em>**kargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Stoner/Analysis.html#AnalysisMixin.lmfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Stoner.Analysis.AnalysisMixin.lmfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around lmfit module fitting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>lmfit.Model</em>) &#8211; An instance of an lmfit.Model that represents the model to be fitted to the data</li>
<li><strong>xcol</strong> (<em>index or None</em>) &#8211; Columns to be used for the x  data for the fitting. If not givem defaults to the <a class="reference internal" href="Stoner.Core.DataFile.html#Stoner.Core.DataFile.setas" title="Stoner.Core.DataFile.setas"><code class="xref py py-attr docutils literal"><span class="pre">Stoner.Core.DataFile.setas</span></code></a> x column</li>
<li><strong>ycol</strong> (<em>index or None</em>) &#8211; Columns to be used for the  y data for the fitting. If not givem defaults to the <a class="reference internal" href="Stoner.Core.DataFile.html#Stoner.Core.DataFile.setas" title="Stoner.Core.DataFile.setas"><code class="xref py py-attr docutils literal"><span class="pre">Stoner.Core.DataFile.setas</span></code></a> y column</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>p0</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; A vector of initial parameter values to try.</li>
<li><strong>sigma</strong> (<em>index</em>) &#8211; The index of the column with the y-error bars</li>
<li><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#callable" title="(in Python v2.7)"><em>callable</em></a>) &#8211; A callable object that evaluates true if a row is to be included. Should be of the form f(x,y)</li>
<li><strong>result</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Determines whether the fitted data should be added into the DataFile object. If result is True then
the last column will be used. If result is a string or an integer then it is used as a column index.
Default to None for not adding fitted data</li>
<li><strong>replace</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; Inidcatesa whether the fitted data replaces existing data or is inserted as a new column (default False)</li>
<li><strong>header</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) &#8211; If this is a string then it is used as the name of the fitted data. (default None)</li>
<li><strong>scale_covar</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; whether to automatically scale covariance matrix (leastsq only)</li>
<li><strong>output</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>default &quot;fit&quot;</em>) &#8211; Specifiy what to return.</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The lmfit module will refurn an instance of the <code class="xref py py-class docutils literal"><span class="pre">lmfit.models.ModelFit</span></code> class that contains all
relevant information about the fit.</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>The return value is determined by the <em>output</em> parameter. Options are</dt>
<dd><ul class="first last simple">
<li>&#8220;ffit&#8221;    just the <code class="xref py py-class docutils literal"><span class="pre">lmfit.model.ModelFit</span></code> instance</li>
<li>&#8220;row&#8221;     just a one dimensional numpy array of the fit paraeters interleaved with their uncertainties</li>
<li>&#8220;full&#8221;    a tuple of the fit instance and the row.</li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="Stoner.Analysis.AnalysisMixin.curve_fit.html#Stoner.Analysis.AnalysisMixin.curve_fit" title="Stoner.Analysis.AnalysisMixin.curve_fit"><code class="xref py py-meth docutils literal"><span class="pre">AnalysisMixin.curve_fit()</span></code></a>
User guide section <a class="reference internal" href="../UserGuide/analysisfile.html#fitting-with-limits"><span class="std std-ref">Fitting with limits</span></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<blockquote>
<div>If <em>p0</em> is fed a 2D array, then it assumed that you want to calculate <span class="math">\(\chi^2\)</span> for different starting parameters
with some variables fixed. In this mode, fitting is carried out repeatedly with each row representing one attempt with different
values of the parameters. In this mode the return value is a 2D array whose rows correspond to the inputs to the rows of p0, the
columns are the fitted values of the parameters with an additional column for <span class="math">\(\chi^2\)</span>.</div></blockquote>
<dl class="last docutils">
<dt>Example:</dt>
<dd><div class="first highlight-python"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Simple use of lmfit to fit data.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">Stoner</span> <span class="kn">import</span> <span class="n">Data</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linspace</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="n">random</span>

<span class="c1">#Make some data</span>
<span class="n">x</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mf">1.7</span><span class="p">)</span><span class="o">+</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="n">d</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">column_headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span><span class="s2">&quot;Signal&quot;</span><span class="p">],</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span>

<span class="n">d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;ro&quot;</span><span class="p">)</span> <span class="c1"># plot our data</span>

<span class="c1">#Do the fitting and plot the result</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">lmfit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">:</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="n">C</span><span class="p">),</span><span class="n">result</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span><span class="n">A</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">B</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;x.y&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">labels</span><span class="o">=</span><span class="p">[]</span>
<span class="n">d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;b-&quot;</span><span class="p">)</span>

<span class="c1"># Make nice label of the parameters</span>
<span class="n">text</span><span class="o">=</span><span class="s2">r&quot;$y=A+Be^{-x/C}$&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
<span class="n">text</span><span class="o">+=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">latex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Model:A&quot;</span><span class="p">,</span><span class="s2">&quot;Model:B&quot;</span><span class="p">,</span><span class="s2">&quot;Model:C&quot;</span><span class="p">]])</span>
<span class="n">d</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../samples/lmfit_simple.py">Source code</a>, <a class="reference external" href="../samples/lmfit_simple.png">png</a>, <a class="reference external" href="../samples/lmfit_simple.hires.png">hires.png</a>, <a class="reference external" href="../samples/lmfit_simple.pdf">pdf</a>)</p>
<div class="last figure">
<img alt="../_images/lmfit_simple.png" src="../_images/lmfit_simple.png" />
</div>
</dd>
</dl>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/StonerLogo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="Stoner.Analysis.AnalysisMixin.interpolate.html"
                        title="previous chapter">AnalysisMixin.interpolate</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Stoner.Analysis.AnalysisMixin.make_bins.html"
                        title="next chapter">AnalysisMixin.make_bins</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/classes/Stoner.Analysis.AnalysisMixin.lmfit.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Stoner.Analysis.AnalysisMixin.make_bins.html" title="AnalysisMixin.make_bins"
             >next</a> |</li>
        <li class="right" >
          <a href="Stoner.Analysis.AnalysisMixin.interpolate.html" title="AnalysisMixin.interpolate"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Stoner Package</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../Stoner.html" >Stoner Package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="Stoner.Analysis.AnalysisMixin.html" >Stoner.Analysis.AnalysisMixin</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-15, Gavin Burnell et al.
      Last updated on Apr 20, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>